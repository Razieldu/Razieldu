<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Udemy Web Development Ch31-1 Authentication-and-Security | Jeremy's Blog</title><meta name="author" content="Jeremy"><meta name="copyright" content="Jeremy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Introduction to Authentication使用authentication的原因  建立帳號  使用者建立個別使用者的帳密,讓他們能儲存個別的資料,我們給予他們每一位使用者一個id來辨識每一個用戶  登入  用戶登入的時候可以讀取他們個人資料  Restrict Access  像登入Netflix一樣,訂閱者就可以享受平台的影音資源 Creating a website whe">
<meta property="og:type" content="article">
<meta property="og:title" content="Udemy Web Development Ch31-1 Authentication-and-Security">
<meta property="og:url" content="https://razieldu.github.io/2022/04/21/Udemy-WebDevelopment-ch31-1-Authentication-and-Security/index.html">
<meta property="og:site_name" content="Jeremy&#39;s Blog">
<meta property="og:description" content="Introduction to Authentication使用authentication的原因  建立帳號  使用者建立個別使用者的帳密,讓他們能儲存個別的資料,我們給予他們每一位使用者一個id來辨識每一個用戶  登入  用戶登入的時候可以讀取他們個人資料  Restrict Access  像登入Netflix一樣,訂閱者就可以享受平台的影音資源 Creating a website whe">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg">
<meta property="article:published_time" content="2022-04-21T06:50:18.000Z">
<meta property="article:modified_time" content="2022-04-28T04:52:58.886Z">
<meta property="article:author" content="Jeremy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://razieldu.github.io/2022/04/21/Udemy-WebDevelopment-ch31-1-Authentication-and-Security/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Udemy Web Development Ch31-1 Authentication-and-Security',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-28 12:52:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">75</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jeremy's Blog</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Udemy Web Development Ch31-1 Authentication-and-Security</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-04-21T06:50:18.000Z" title="Created 2022-04-21 14:50:18">2022-04-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-04-28T04:52:58.886Z" title="Updated 2022-04-28 12:52:58">2022-04-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web-development/">Web development</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Udemy Web Development Ch31-1 Authentication-and-Security"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="Introduction-to-Authentication"><a href="#Introduction-to-Authentication" class="headerlink" title="Introduction to Authentication"></a>Introduction to Authentication</h3><p>使用authentication的原因</p>
<ol>
<li>建立帳號</li>
</ol>
<p>使用者建立個別使用者的帳密,讓他們能儲存個別的資料,我們給予他們每一位使用者一個id來辨識每一個用戶</p>
<ol start="2">
<li>登入</li>
</ol>
<p>用戶登入的時候可以讀取他們個人資料</p>
<ol start="3">
<li>Restrict Access</li>
</ol>
<p>像登入Netflix一樣,訂閱者就可以享受平台的影音資源</p>
<p>Creating a website where we sign up and login users seems simple enough but the difficult part part of authentication comes from how secure you are going to make you website.</p>
<p><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC31%E7%AF%80%E5%B0%88%E6%A1%88%E8%B3%87%E6%96%99%E5%A4%BE%E7%B5%90%E6%A7%8B.png" alt="網頁開發第31節 專案資料夾結構.png"></p>
<h3 id="專案程式碼"><a href="#專案程式碼" class="headerlink" title="專案程式碼"></a>專案程式碼</h3><p><strong>app.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const ejs = require(&quot;ejs&quot;);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;));</span><br><span class="line">app.set(&quot;view engine&quot;,&quot;ejs&quot;);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:true&#125;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.listen(&quot;3000&quot;,function()&#123;</span><br><span class="line">    console.log(&quot;Server successfully run on port 3000&quot;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>style.css</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">  background-color: #E8ECEF;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.centered &#123;</span><br><span class="line">    padding-top: 200px;</span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.secret-text &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 2rem;</span><br><span class="line">  color: #fff;</span><br><span class="line">  background-color: #000;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>header.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">  &lt;title&gt;Secrets&lt;/title&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.6.3/css/all.css&quot; integrity=&quot;sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/&quot; crossorigin=&quot;anonymous&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css&quot; integrity=&quot;sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS&quot; crossorigin=&quot;anonymous&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;css/styles.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br></pre></td></tr></table></figure>

<p><strong>footer.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><strong>home.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&#x27;partials/header&#x27;) %&gt;</span><br><span class="line">&lt;div class=&quot;jumbotron centered&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;fas fa-key fa-6x&quot;&gt;&lt;/i&gt;</span><br><span class="line">    &lt;h1 class=&quot;display-3&quot;&gt;Secrets&lt;/h1&gt;</span><br><span class="line">    &lt;p class=&quot;lead&quot;&gt;Don&#x27;t keep your secrets, share them anonymously!&lt;/p&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;a class=&quot;btn btn-light btn-lg&quot; href=&quot;/register&quot; role=&quot;button&quot;&gt;Register&lt;/a&gt;</span><br><span class="line">    &lt;a class=&quot;btn btn-dark btn-lg&quot; href=&quot;/login&quot; role=&quot;button&quot;&gt;Login&lt;/a&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;%- include(&#x27;partials/footer&#x27;) %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>login.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&#x27;partials/header&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;container mt-5&quot;&gt;</span><br><span class="line">  &lt;h1&gt;Login&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;col-sm-8&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;card&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;!-- Makes POST request to /login route --&gt;</span><br><span class="line">          &lt;form action=&quot;/login&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">              &lt;label for=&quot;email&quot;&gt;Email&lt;/label&gt;</span><br><span class="line">              &lt;input type=&quot;email&quot; class=&quot;form-control&quot; name=&quot;username&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">              &lt;label for=&quot;password&quot;&gt;Password&lt;/label&gt;</span><br><span class="line">              &lt;input type=&quot;password&quot; class=&quot;form-control&quot; name=&quot;password&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;button type=&quot;submit&quot; class=&quot;btn btn-dark&quot;&gt;Login&lt;/button&gt;</span><br><span class="line">          &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- &lt;div class=&quot;col-sm-4&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;card&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line">          &lt;a class=&quot;btn btn-block&quot; href=&quot;/auth/google&quot; role=&quot;button&quot;&gt;</span><br><span class="line">            &lt;i class=&quot;fab fa-google&quot;&gt;&lt;/i&gt;</span><br><span class="line">            Sign In with Google</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt; --&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- include(&#x27;partials/footer&#x27;) %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>register.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&#x27;partials/header&#x27;) %&gt;</span><br><span class="line">&lt;div class=&quot;container mt-5&quot;&gt;</span><br><span class="line">  &lt;h1&gt;Register&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;col-sm-8&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;card&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;!-- Makes POST request to /register route --&gt;</span><br><span class="line">          &lt;form action=&quot;/register&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">              &lt;label for=&quot;email&quot;&gt;Email&lt;/label&gt;</span><br><span class="line">              &lt;input type=&quot;email&quot; class=&quot;form-control&quot; name=&quot;username&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">              &lt;label for=&quot;password&quot;&gt;Password&lt;/label&gt;</span><br><span class="line">              &lt;input type=&quot;password&quot; class=&quot;form-control&quot; name=&quot;password&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;button type=&quot;submit&quot; class=&quot;btn btn-dark&quot;&gt;Register&lt;/button&gt;</span><br><span class="line">          &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> ////////////////////////////////////   </span><br><span class="line">    &lt;!-- &lt;div class=&quot;col-sm-4&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;card social-block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line">          &lt;a class=&quot;btn btn-block&quot; href=&quot;/auth/google&quot; role=&quot;button&quot;&gt;</span><br><span class="line">            &lt;i class=&quot;fab fa-google&quot;&gt;&lt;/i&gt;</span><br><span class="line">            Sign Up with Google</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt; --&gt;</span><br><span class="line">////////////////////////////////////</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;%- include(&#x27;partials/header&#x27;) %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>secrets.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&#x27;partials/header&#x27;) %&gt;</span><br><span class="line">&lt;div class=&quot;jumbotron text-center&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;fas fa-key fa-6x&quot;&gt;&lt;/i&gt;</span><br><span class="line">    &lt;h1 class=&quot;display-3&quot;&gt;You&#x27;ve Discovered My Secret!&lt;/h1&gt;</span><br><span class="line">    &lt;p class=&quot;secret-text&quot;&gt;Jack Bauer is my hero.&lt;/p&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;a class=&quot;btn btn-light btn-lg&quot; href=&quot;/logout&quot; role=&quot;button&quot;&gt;Log Out&lt;/a&gt;</span><br><span class="line">    &lt;a class=&quot;btn btn-dark btn-lg&quot; href=&quot;/submit&quot; role=&quot;button&quot;&gt;Submit a Secret&lt;/a&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;%- include(&#x27;partials/footer&#x27;) %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>submit.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&#x27;partials/header&#x27;) %&gt;</span><br><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;jumbotron centered&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;fas fa-key fa-6x&quot;&gt;&lt;/i&gt;</span><br><span class="line">    &lt;h1 class=&quot;display-3&quot;&gt;Secrets&lt;/h1&gt;</span><br><span class="line">    &lt;p class=&quot;secret-text&quot;&gt;Don&#x27;t keep your secrets, share them anonymously!&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form action=&quot;/submit&quot; method=&quot;POST&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; class=&quot;form-control text-center&quot; name=&quot;secret&quot; placeholder=&quot;What&#x27;s your secret?&quot;&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;button type=&quot;submit&quot; class=&quot;btn btn-dark&quot;&gt;Submit&lt;/button&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;%- include(&#x27;partials/footer&#x27;) %&gt;</span><br></pre></td></tr></table></figure>

<h3 id="基礎設置"><a href="#基礎設置" class="headerlink" title="基礎設置"></a>基礎設置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm i express ejs body-parser</span><br></pre></td></tr></table></figure>

<p>app.js(把各個網頁連接起來)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;home&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/login&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;login&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/register&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;register&quot;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Level-1-Register-users-with-Username-and-Password"><a href="#Level-1-Register-users-with-Username-and-Password" class="headerlink" title="Level 1 Register users with Username and Password"></a>Level 1 Register users with Username and Password</h3><h3 id="建立使用者資料庫儲存Email以及密碼"><a href="#建立使用者資料庫儲存Email以及密碼" class="headerlink" title="建立使用者資料庫儲存Email以及密碼"></a>建立使用者資料庫儲存Email以及密碼</h3><ol>
<li><p>安裝mongoose</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mongoose</span><br></pre></td></tr></table></figure>
</li>
<li><p>資料庫設定</p>
</li>
</ol>
<p><strong>app.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const ejs = require(&quot;ejs&quot;);</span><br><span class="line">const mongoose = require(&quot;mongoose&quot;);  //導入mongoose</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;));</span><br><span class="line">app.set(&quot;view engine&quot;,&quot;ejs&quot;);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:true&#125;));</span><br><span class="line"></span><br><span class="line">mongoose.connect(&quot;mongodb://localhost:27017/userDB&quot;,&#123;useNewUrlParser:true&#125;); </span><br><span class="line">//伺服器連結userDB資料庫</span><br><span class="line"></span><br><span class="line">const userSchema=&#123;    //文件的在資料庫的架構</span><br><span class="line">email:String,</span><br><span class="line">password:String</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const User = new mongoose.model(&quot;User&quot;,userSchema); </span><br><span class="line">//把文件架構導入collection:User,必須為單數型態</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>設定註冊頁面並接收使用者資料並存入資料庫</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/register&quot;,function(req,res)&#123;</span><br><span class="line">const newUser = new User(&#123;</span><br><span class="line">   email:req.body.username,</span><br><span class="line">  password:req.body.password</span><br><span class="line">&#125;);</span><br><span class="line">newUser.save(function(err)&#123;</span><br><span class="line">  if(err)&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    res.render(&quot;secrets&quot;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="有條件的登入頁面"><a href="#有條件的登入頁面" class="headerlink" title="有條件的登入頁面"></a>有條件的登入頁面</h3><p>我們使用了app.get(“&#x2F;“).get(“register”).get(“login”)但是明明還有secret.ejs以及submit.ejs頁面,為什麼沒有直接把他app.get出來呢?</p>
<p>因為secret頁面以及submit頁面,都是需要登入或是註冊之後才能夠開始使用</p>
<ol start="4">
<li>處理登入頁面並與資料庫連動</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/login&quot;,function(req,res)&#123;</span><br><span class="line">  const userName=req.body.username;</span><br><span class="line">  const passWord=req.body.password;</span><br><span class="line">   User.findOne(&#123;email:userName&#125;,function(err,foundUser)&#123;</span><br><span class="line">     if(err)&#123;</span><br><span class="line">       console.log(err)</span><br><span class="line">     &#125;else&#123;</span><br><span class="line">       if(foundUser)&#123;</span><br><span class="line">           //假設有找到這個email,email確認</span><br><span class="line">          if(foundUser.password===passWord)&#123;    </span><br><span class="line">            //假設使用者輸入的密碼也等於我們找到的這組email的密碼</span><br><span class="line">            res.render(&quot;secrets&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>密碼以及帳戶可以透過資料庫的操作者直接看到,因此要想辦法解決這個問題</p>
<h3 id="Level-2-Database-Encryption"><a href="#Level-2-Database-Encryption" class="headerlink" title="Level 2 Database Encryption"></a>Level 2 Database Encryption</h3><p>Caesar Cipher:透過字母的平行移動來進行編碼 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A B C D E F G </span><br><span class="line"></span><br><span class="line">C D E F G H I</span><br></pre></td></tr></table></figure>
<p>BEEF&#x3D;DCCH</p>
<p>Essentially all encryption works exactly the same way. You have a way of scrambling(擾亂) your message and it requires a key to be able to unscramble(解碼) the message.</p>
<h3 id="使用mongoose-encryption-npm套件"><a href="#使用mongoose-encryption-npm套件" class="headerlink" title="使用mongoose-encryption npm套件"></a>使用mongoose-encryption npm套件</h3><p>During <strong>save</strong>, documents are encrypted and then signed. During <strong>find</strong>, documents are authenticated and then decrypted<br>(當我們存資料進去資料庫會自動編碼,當我們讀取資料的時候,會自動進行解碼)</p>
<p>安裝moodgoose-encryption</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mongoose-encryption</span><br></pre></td></tr></table></figure>


<h3 id="選擇一種導入app-js的方式"><a href="#選擇一種導入app-js的方式" class="headerlink" title="選擇一種導入app.js的方式"></a>選擇一種導入app.js的方式</h3><p><strong>Secret String Instead of Two Keys</strong><br>For convenience, you can also pass in a single secret string instead of two keys.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var secret = process.env.SOME_LONG_UNGUESSABLE_STRING;//一段長的string可以使用想要的句子</span><br><span class="line">userSchema.plugin(encrypt, &#123; secret: secret &#125;);</span><br></pre></td></tr></table></figure>

<p>app.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const ejs = require(&quot;ejs&quot;);</span><br><span class="line">const mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">const encrypt = require(&quot;mongoose-encrytion&quot;); //導入套件</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;));</span><br><span class="line">app.set(&quot;view engine&quot;,&quot;ejs&quot;);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:true&#125;));</span><br><span class="line"></span><br><span class="line">mongoose.connect(&quot;mongodb://localhost:27017/userDB&quot;,&#123;useNewUrlParser:true&#125;);</span><br><span class="line"></span><br><span class="line">const userSchema= new mongoose.Schema(&#123;</span><br><span class="line">email:String,</span><br><span class="line">password:String</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const secret = &quot;Thisisthemostimportantsecret&quot;;  </span><br><span class="line">userSchema.plugin(encrypt, &#123; secret: secret , encryptedFields: [&quot;password&quot;] &#125;);</span><br><span class="line"></span><br><span class="line">//導入mongoose-encryption,要在我們設定的mongoose model之前(下一行),因為要先把原先的schema變成加密的狀態.加入encryptedFields: [&quot;passWord&quot;],代表只有password的部分我們想進行編碼</span><br><span class="line">const User = new mongoose.model(&quot;User&quot;,userSchema);</span><br></pre></td></tr></table></figure>

<p>此時我們到首頁進行註冊,然後到資料庫找尋該筆資料,資料庫顯示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;6261741459bdd66d750887f9&quot;), &quot;email&quot; : &quot;s202032808@gmail.com&quot;, &quot;_ct&quot; : BinData(0,&quot;YRJWN7XGP0dlaDBG6PC00xYxIgwboJJzsSnG1WxE23BzZ6IxfODbZHM0SF6FcHrPkA==&quot;), &quot;_ac&quot; : BinData(0,&quot;YaUdjfGLzBfCFd/7uXRZhmwX9fR45R25+48mz2wwv0P1WyJfaWQiLCJfY3QiXQ==&quot;), &quot;__v&quot; : 0 &#125;</span><br></pre></td></tr></table></figure>
<p>可以看到密碼的部分已經進行編碼</p>
<p>so this does mean that if somebody was to hack into your website ,then they probably will get access to your app.js,and once they do,they will find the const secret,and once they found your secret then they can use the same package to decrypt all of your users passwords.</p>
<h3 id="Using-Environment-Variables-to-Keep-Secrets-Safe"><a href="#Using-Environment-Variables-to-Keep-Secrets-Safe" class="headerlink" title="Using Environment Variables to Keep Secrets Safe"></a>Using Environment Variables to Keep Secrets Safe</h3><h3 id="Dotenv"><a href="#Dotenv" class="headerlink" title="Dotenv"></a>Dotenv</h3><p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/dotenv">https://www.npmjs.com/package/dotenv</a></p>
<p>安裝</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i dotenv</span><br></pre></td></tr></table></figure>

<p>置入app.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">require(&quot;dotenv&quot;).config();  ///盡量放在最上方</span><br><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const ejs = require(&quot;ejs&quot;);</span><br><span class="line">const mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">const encrypt = require(&quot;mongoose-encryption&quot;);</span><br></pre></td></tr></table></figure>

<p>We are not actually setting a constant for it because all we need to do is just require it and then call config on it and we do not need it again</p>
<p>建立一個.env file(隱藏檔案)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch .env</span><br></pre></td></tr></table></figure>

<p>在app.js剪下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const secret = &quot;Thisisthemostimportantsecret.&quot;;</span><br></pre></td></tr></table></figure>

<p>.env(檔案頁面)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">S3_BUCKET=&quot;YOURS3BUCKET&quot; //這行其實可以移除</span><br><span class="line">SECRET_KEY=&quot;THISISTHEMOSTIMPORTANTSECRET&quot;</span><br></pre></td></tr></table></figure>

<p>We already require our dotenv package and we have configured(配置)it to be able to access our environmental variables then anywhere after this line we should be able to tap in to those variables by referring to them </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">require(&quot;dotenv&quot;).config();</span><br><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const ejs = require(&quot;ejs&quot;);</span><br><span class="line">const mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">const encrypt = require(&quot;mongoose-encryption&quot;);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">console.log(process.env.API_KEY) //新增這行進行測試</span><br></pre></td></tr></table></figure>

<p>終端機顯示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TEST</span><br></pre></td></tr></table></figure>

<p>app.js(修改為)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">require(&quot;dotenv&quot;).config();</span><br><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const ejs = require(&quot;ejs&quot;);</span><br><span class="line">const mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">const encrypt = require(&quot;mongoose-encryption&quot;);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;));</span><br><span class="line">app.set(&quot;view engine&quot;,&quot;ejs&quot;);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:true&#125;));</span><br><span class="line"></span><br><span class="line">mongoose.connect(&quot;mongodb://localhost:27017/userDB&quot;,&#123;useNewUrlParser:true&#125;);</span><br><span class="line"></span><br><span class="line">const userSchema= new mongoose.Schema(&#123;</span><br><span class="line">email:String,</span><br><span class="line">password:String</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">userSchema.plugin(encrypt, &#123; secret: process.env.SECRET_KEY,encryptedFields: [&quot;password&quot;] &#125;); //把在env頁面的環境變數套用過來</span><br><span class="line"></span><br><span class="line">const User = new mongoose.model(&quot;User&quot;,userSchema);</span><br></pre></td></tr></table></figure>

<h3 id="問題點"><a href="#問題點" class="headerlink" title="問題點"></a>問題點</h3><p>當我把專案上傳github時,我的環境變數檔案也會被上傳到github</p>
<h3 id="解決-使用-gitignore檔案來避免環境變數檔案被上傳到github"><a href="#解決-使用-gitignore檔案來避免環境變數檔案被上傳到github" class="headerlink" title="解決:使用.gitignore檔案來避免環境變數檔案被上傳到github"></a>解決:使用.gitignore檔案來避免環境變數檔案被上傳到github</h3><p>前往 <a target="_blank" rel="noopener" href="https://github.com/github/gitignore">https://github.com/github/gitignore</a> ,找到Node.gitignore,複製內容</p>
<p>建立.gitignore檔案</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch .gitignore</span><br></pre></td></tr></table></figure>

<p>.gitignore</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">貼上在github上Node.gitignore複製的內容,這裡擷取一小段</span><br><span class="line"></span><br><span class="line"># Logs</span><br><span class="line">logs</span><br><span class="line">*.log</span><br><span class="line">npm-debug.log*</span><br><span class="line">yarn-debug.log*</span><br><span class="line">yarn-error.log*</span><br><span class="line">lerna-debug.log*</span><br><span class="line">.pnpm-debug.log*</span><br><span class="line"></span><br><span class="line"># Diagnostic reports (https://nodejs.org/api/report.html)</span><br><span class="line">report.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json</span><br></pre></td></tr></table></figure>

<p>可以看到環境變數檔案也在列表裡面</p>
<h3 id="測試"><a href="#測試" class="headerlink" title="測試"></a>測試</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git init </span><br><span class="line">git add .</span><br><span class="line">git commit -m&quot;測試.gitignore&quot;</span><br></pre></td></tr></table></figure>

<p>在github創建repository,複製<a target="_blank" rel="noopener" href="https://github.com/Razieldu/Authentication-Practice-.git">https://github.com/Razieldu/Authentication-Practice-.git</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https://github.com/Razieldu/Authentication-Practice-.git</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<p>確認環境變數檔案沒有被上傳到github</p>
<h3 id="環境變數與Heroku"><a href="#環境變數與Heroku" class="headerlink" title="環境變數與Heroku"></a>環境變數與Heroku</h3><p>Now,when we are ready to deploy our app to Heroku,they actually have a specific way of handling these config VARs because obviously for your app to be able to run it needs access to those secrets. There is a special pane that you will be able to see on your dashboard where you can set those config VARs especially inside Heroku,they will keep those safe off the internet,so keeping your API keys and your encryption</p>
<h3 id="Heroku-設置"><a href="#Heroku-設置" class="headerlink" title="Heroku 設置"></a>Heroku 設置</h3><p>前往dashboard,點擊該專案,到setting,下拉到Config Vars,輸入環境變數,注意要把string的””去掉</p>
<h3 id="Level-3-Hashing-Passwords"><a href="#Level-3-Hashing-Passwords" class="headerlink" title="Level 3 Hashing Passwords"></a>Level 3 Hashing Passwords</h3><p>Hash function: they designed it to be very quickly going forwards but almost impossible to go backwards ,using current levels of computing power it would take far too long to make it worthwhile for the hacker.</p>
<p>When the user trys to register our website then we ask them for registration password which we turn into a hash using our Hash function and then we store that hash on our database.At later point, the users want to log in and they type their password,then we again hash that password that they type in to produce a hash and then we compare it against the hash that we have stored in our database. And if the two hashes match then that means that the login password is the same as the registration password as well. And at no point in this process do we have to store their password in plaintext or are we able to reverse the process to figure out their password.</p>
<h3 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h3><p>安裝md5</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i md5</span><br></pre></td></tr></table></figure>

<p>移除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const encrypt = require(&quot;mongoose-encryption&quot;);</span><br><span class="line">userSchema.plugin(encrypt, &#123; secret: process.env.SECRET_KEY,encryptedFields: [&quot;password&quot;] &#125;);</span><br></pre></td></tr></table></figure>

<p>app.js(修正)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">//jshint esversion:6</span><br><span class="line">require(&quot;dotenv&quot;).config();</span><br><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const ejs = require(&quot;ejs&quot;);</span><br><span class="line">const mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">const md5 = require(&quot;md5&quot;); //導入md5</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;));</span><br><span class="line">app.set(&quot;view engine&quot;,&quot;ejs&quot;);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:true&#125;));</span><br><span class="line"></span><br><span class="line">mongoose.connect(&quot;mongodb://localhost:27017/userDB&quot;,&#123;useNewUrlParser:true&#125;);</span><br><span class="line"></span><br><span class="line">const userSchema= new mongoose.Schema(&#123;</span><br><span class="line">email:String,</span><br><span class="line">password:String</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const User = new mongoose.model(&quot;User&quot;,userSchema);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;home&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/login&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;login&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/register&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;register&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/register&quot;,function(req,res)&#123;</span><br><span class="line">const newUser = new User(&#123;</span><br><span class="line">   email:req.body.username,</span><br><span class="line">  password:md5(req.body.password)   //使用md5轉換使用者密碼</span><br><span class="line">&#125;);</span><br><span class="line">newUser.save(function(err)&#123;</span><br><span class="line">  if(err)&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    res.render(&quot;secrets&quot;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/login&quot;,function(req,res)&#123;</span><br><span class="line">  const userName=req.body.username;</span><br><span class="line">  const passWord=md5(req.body.password);</span><br><span class="line">   User.findOne(&#123;email:userName&#125;,function(err,foundUser)&#123;</span><br><span class="line">     if(err)&#123;</span><br><span class="line">       console.log(err)</span><br><span class="line">     &#125;else&#123;</span><br><span class="line">       if(foundUser)&#123;</span><br><span class="line">          if(foundUser.password===passWord)&#123;</span><br><span class="line">            res.render(&quot;secrets&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(&quot;3000&quot;,function()&#123;</span><br><span class="line">    console.log(&quot;Server successfully run on port 3000&quot;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Hacking-101"><a href="#Hacking-101" class="headerlink" title="Hacking 101"></a>Hacking 101</h3><p>hash password:同樣的密碼產生同樣的一組hash,把已知的hash整理起來進行對照,建立一個hash table,可以自行弄一個資料庫導入md5套件並且創立大量帳號密碼進行比對</p>
<ol>
<li>all the words from dictionary</li>
<li>all numbers from telephone book</li>
<li>all the combination of characters up to six places </li>
<li>使用最新型的GPU來進行計算</li>
<li>密碼長度以及複雜度決定破解的速度,並且不要使用英文單字</li>
</ol>
<h3 id="Level-4-Salting-and-Hashing-Passwords-with-bcrypt"><a href="#Level-4-Salting-and-Hashing-Passwords-with-bcrypt" class="headerlink" title="Level 4 Salting and Hashing Passwords with bcrypt"></a>Level 4 Salting and Hashing Passwords with bcrypt</h3><h3 id="Salting"><a href="#Salting" class="headerlink" title="Salting"></a>Salting</h3><p>In addition to the password,it also generate a random set of characters and those characters along with the user’s password gets combined nad then put through the hash function. So,the resulting hash is created from both the password as well as the random unique salt,so that means no matter how simple the password of the user is adding the salt increase the complexity, increase the number of our characters and we make our user database a lot more secure.</p>
<p>使用者的密碼加上隨機產生的一組密碼結合起來之後再進行hash</p>
<p>(password + salt) 在進行hash</p>
<h3 id="Salt-rounds"><a href="#Salt-rounds" class="headerlink" title="Salt rounds"></a>Salt rounds</h3><p>(password+salt)&#x3D;hash1</p>
<p>(hash1+salt)&#x3D;hash2</p>
<p>When we hashing user’s password using bcrypt,we can set the number of round we want to salt our password,we only have to add the <strong>salt round</strong> to increase the security of user’s password.</p>
<p>Come back to that user database we will have each <strong>user’s username</strong> stored, we will have their <strong>randomly generated salt</strong> stored,and then we will store <strong>their hash after a set number of salting rounds</strong></p>
<h3 id="想要轉換node版本可以使用nvm"><a href="#想要轉換node版本可以使用nvm" class="headerlink" title="想要轉換node版本可以使用nvm"></a>想要轉換node版本可以使用nvm</h3><p><a target="_blank" rel="noopener" href="https://github.com/nvm-sh/nvm">https://github.com/nvm-sh/nvm</a></p>
<p>安裝</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash</span><br></pre></td></tr></table></figure>

<p>安裝(github)套件遇到問題時,可以到repository的issues找解答</p>
<h3 id="bcrypt"><a href="#bcrypt" class="headerlink" title="bcrypt"></a>bcrypt</h3><p><a target="_blank" rel="noopener" href="https://github.com/nvm-sh/nvm#installing-and-updating">https://github.com/nvm-sh/nvm#installing-and-updating</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i bcrypt</span><br></pre></td></tr></table></figure>

<p>移除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const md5 = require(&quot;md5&quot;);</span><br></pre></td></tr></table></figure>

<p>app.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">require(&quot;dotenv&quot;).config();</span><br><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const ejs = require(&quot;ejs&quot;);</span><br><span class="line">const mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">const bcrypt = require(&quot;bcrypt&quot;); //導入</span><br><span class="line">const saltRounds = 10; //調整次數</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;));</span><br><span class="line">app.set(&quot;view engine&quot;,&quot;ejs&quot;);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:true&#125;));</span><br><span class="line"></span><br><span class="line">mongoose.connect(&quot;mongodb://localhost:27017/userDB&quot;,&#123;useNewUrlParser:true&#125;);</span><br><span class="line"></span><br><span class="line">const userSchema= new mongoose.Schema(&#123;</span><br><span class="line">email:String,</span><br><span class="line">password:String</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const User = new mongoose.model(&quot;User&quot;,userSchema);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;home&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/login&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;login&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/register&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">res.render(&quot;register&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/register&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">bcrypt.hash(req.body.password, saltRounds, function(err, hash) &#123;  //導入使用者密碼並儲存</span><br><span class="line">  const newUser = new User(&#123;</span><br><span class="line">     email:req.body.username,</span><br><span class="line">    password:hash</span><br><span class="line">  &#125;);</span><br><span class="line">  newUser.save(function(err)&#123;</span><br><span class="line">    if(err)&#123;</span><br><span class="line">      console.log(err);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      res.render(&quot;secrets&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/login&quot;,function(req,res)&#123;</span><br><span class="line">  const userName=req.body.username;</span><br><span class="line">  const passWord=req.body.password;</span><br><span class="line">   User.findOne(&#123;email:userName&#125;,function(err,foundUser)&#123;</span><br><span class="line">     if(err)&#123;</span><br><span class="line">       console.log(err)</span><br><span class="line">     &#125;else&#123;</span><br><span class="line">       if(foundUser)&#123;</span><br><span class="line">         bcrypt.compare(passWord, foundUser.password, function(err, result) &#123;</span><br><span class="line">           //foundUser為javascript物件,foundUser.password找尋hash</span><br><span class="line">          if(result===true)&#123;</span><br><span class="line">            res.render(&quot;secrets&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(&quot;3000&quot;,function()&#123;</span><br><span class="line">    console.log(&quot;Server successfully run on port 3000&quot;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://razieldu.github.io">Jeremy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://razieldu.github.io/2022/04/21/Udemy-WebDevelopment-ch31-1-Authentication-and-Security/">https://razieldu.github.io/2022/04/21/Udemy-WebDevelopment-ch31-1-Authentication-and-Security/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/04/23/Udemy-WebDevelopment-ch31-2-Authentication-and-Security/"><img class="prev-cover" src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Udemy Web Development Ch31-2 Authentication-and-Security</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/18/Udemy-WebDevelopment-ch30-Build-Your-Own-RESTful-API-from-Scratch/"><img class="next-cover" src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Udemy Web Development Ch30 Build Your Own RESTful API from Scratch</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jeremy</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">75</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Razieldu"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Introduction-to-Authentication"><span class="toc-number">1.</span> <span class="toc-text">Introduction to Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%88%E6%A1%88%E7%A8%8B%E5%BC%8F%E7%A2%BC"><span class="toc-number">2.</span> <span class="toc-text">專案程式碼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A4%8E%E8%A8%AD%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">基礎設置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Level-1-Register-users-with-Username-and-Password"><span class="toc-number">4.</span> <span class="toc-text">Level 1 Register users with Username and Password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E4%BD%BF%E7%94%A8%E8%80%85%E8%B3%87%E6%96%99%E5%BA%AB%E5%84%B2%E5%AD%98Email%E4%BB%A5%E5%8F%8A%E5%AF%86%E7%A2%BC"><span class="toc-number">5.</span> <span class="toc-text">建立使用者資料庫儲存Email以及密碼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E6%A2%9D%E4%BB%B6%E7%9A%84%E7%99%BB%E5%85%A5%E9%A0%81%E9%9D%A2"><span class="toc-number">6.</span> <span class="toc-text">有條件的登入頁面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Level-2-Database-Encryption"><span class="toc-number">7.</span> <span class="toc-text">Level 2 Database Encryption</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8mongoose-encryption-npm%E5%A5%97%E4%BB%B6"><span class="toc-number">8.</span> <span class="toc-text">使用mongoose-encryption npm套件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%B8%E6%93%87%E4%B8%80%E7%A8%AE%E5%B0%8E%E5%85%A5app-js%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">9.</span> <span class="toc-text">選擇一種導入app.js的方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-Environment-Variables-to-Keep-Secrets-Safe"><span class="toc-number">10.</span> <span class="toc-text">Using Environment Variables to Keep Secrets Safe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dotenv"><span class="toc-number">11.</span> <span class="toc-text">Dotenv</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%95%8F%E9%A1%8C%E9%BB%9E"><span class="toc-number">12.</span> <span class="toc-text">問題點</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B1%BA-%E4%BD%BF%E7%94%A8-gitignore%E6%AA%94%E6%A1%88%E4%BE%86%E9%81%BF%E5%85%8D%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E6%AA%94%E6%A1%88%E8%A2%AB%E4%B8%8A%E5%82%B3%E5%88%B0github"><span class="toc-number">13.</span> <span class="toc-text">解決:使用.gitignore檔案來避免環境變數檔案被上傳到github</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%AC%E8%A9%A6"><span class="toc-number">14.</span> <span class="toc-text">測試</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%88%87Heroku"><span class="toc-number">15.</span> <span class="toc-text">環境變數與Heroku</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Heroku-%E8%A8%AD%E7%BD%AE"><span class="toc-number">16.</span> <span class="toc-text">Heroku 設置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Level-3-Hashing-Passwords"><span class="toc-number">17.</span> <span class="toc-text">Level 3 Hashing Passwords</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#md5"><span class="toc-number">18.</span> <span class="toc-text">md5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hacking-101"><span class="toc-number">19.</span> <span class="toc-text">Hacking 101</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Level-4-Salting-and-Hashing-Passwords-with-bcrypt"><span class="toc-number">20.</span> <span class="toc-text">Level 4 Salting and Hashing Passwords with bcrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Salting"><span class="toc-number">21.</span> <span class="toc-text">Salting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Salt-rounds"><span class="toc-number">22.</span> <span class="toc-text">Salt rounds</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%83%B3%E8%A6%81%E8%BD%89%E6%8F%9Bnode%E7%89%88%E6%9C%AC%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8nvm"><span class="toc-number">23.</span> <span class="toc-text">想要轉換node版本可以使用nvm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bcrypt"><span class="toc-number">24.</span> <span class="toc-text">bcrypt</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/08/Redux-Thunk%20VS%20Redux-Saga/" title="Redux-Thunk VS Redux-Saga"><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redux-Thunk VS Redux-Saga"/></a><div class="content"><a class="title" href="/2022/08/08/Redux-Thunk%20VS%20Redux-Saga/" title="Redux-Thunk VS Redux-Saga">Redux-Thunk VS Redux-Saga</a><time datetime="2022-08-08T04:43:06.000Z" title="Created 2022-08-08 12:43:06">2022-08-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/05/Udemy-React-TheCompleteGuide-ch23-Next-JS/" title="Udemy-React-TheCompleteGuide ch23 Next JS  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch23 Next JS  "/></a><div class="content"><a class="title" href="/2022/08/05/Udemy-React-TheCompleteGuide-ch23-Next-JS/" title="Udemy-React-TheCompleteGuide ch23 Next JS  ">Udemy-React-TheCompleteGuide ch23 Next JS  </a><time datetime="2022-08-05T08:51:55.000Z" title="Created 2022-08-05 16:51:55">2022-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/24/Redux-VS-Redux-ToolKit/" title="Redux VS Redux-ToolKit"><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redux VS Redux-ToolKit"/></a><div class="content"><a class="title" href="/2022/07/24/Redux-VS-Redux-ToolKit/" title="Redux VS Redux-ToolKit">Redux VS Redux-ToolKit</a><time datetime="2022-07-24T04:43:06.000Z" title="Created 2022-07-24 12:43:06">2022-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/15/Udemy-React-TheCompleteGuide-ch22-React-Authentication/" title="Udemy-React-TheCompleteGuide ch22 React Authenticaton  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch22 React Authenticaton  "/></a><div class="content"><a class="title" href="/2022/07/15/Udemy-React-TheCompleteGuide-ch22-React-Authentication/" title="Udemy-React-TheCompleteGuide ch22 React Authenticaton  ">Udemy-React-TheCompleteGuide ch22 React Authenticaton  </a><time datetime="2022-07-15T07:47:55.000Z" title="Created 2022-07-15 15:47:55">2022-07-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/14/Udemy-React-TheCompleteGuide-ch21-React-Deploy/" title="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  "/></a><div class="content"><a class="title" href="/2022/07/14/Udemy-React-TheCompleteGuide-ch21-React-Deploy/" title="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  ">Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  </a><time datetime="2022-07-14T05:39:55.000Z" title="Created 2022-07-14 13:39:55">2022-07-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Jeremy</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>