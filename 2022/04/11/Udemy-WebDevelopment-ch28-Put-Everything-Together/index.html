<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Udemy Web Development Ch28 Put Everything Together | Jeremy's Blog</title><meta name="author" content="Jeremy"><meta name="copyright" content="Jeremy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="專案程式碼 app.js 12345678910111213141516171819202122232425262728293031323334353637383940414243444546const express &#x3D; require(&quot;express&quot;);const bodyParser &#x3D; require(&quot;body-parser&quot;);const d">
<meta property="og:type" content="article">
<meta property="og:title" content="Udemy Web Development Ch28 Put Everything Together">
<meta property="og:url" content="https://razieldu.github.io/2022/04/11/Udemy-WebDevelopment-ch28-Put-Everything-Together/index.html">
<meta property="og:site_name" content="Jeremy&#39;s Blog">
<meta property="og:description" content="專案程式碼 app.js 12345678910111213141516171819202122232425262728293031323334353637383940414243444546const express &#x3D; require(&quot;express&quot;);const bodyParser &#x3D; require(&quot;body-parser&quot;);const d">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg">
<meta property="article:published_time" content="2022-04-11T15:08:10.000Z">
<meta property="article:modified_time" content="2022-04-28T04:52:31.770Z">
<meta property="article:author" content="Jeremy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://razieldu.github.io/2022/04/11/Udemy-WebDevelopment-ch28-Put-Everything-Together/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Udemy Web Development Ch28 Put Everything Together',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-28 12:52:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">74</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jeremy's Blog</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Udemy Web Development Ch28 Put Everything Together</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-04-11T15:08:10.000Z" title="Created 2022-04-11 23:08:10">2022-04-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-04-28T04:52:31.770Z" title="Updated 2022-04-28 12:52:31">2022-04-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web-development/">Web development</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Udemy Web Development Ch28 Put Everything Together"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="專案程式碼"><a href="#專案程式碼" class="headerlink" title="專案程式碼"></a>專案程式碼</h3><p><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC28%E7%AF%80%E8%B3%87%E6%96%99%E5%A4%BE%E7%B5%90%E6%A7%8B.png" alt="網頁開發28節資料夾結構.png"></p>
<p><strong>app.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const date = require(__dirname + &quot;/date.js&quot;);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.set(&#x27;view engine&#x27;, &#x27;ejs&#x27;);</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended: true&#125;));</span><br><span class="line">app.use(express.static(&quot;public&quot;));</span><br><span class="line"></span><br><span class="line">const items=[&quot;Buy food&quot;,&quot;Cook Food&quot;,&quot;Eat Food&quot;];</span><br><span class="line">const workItems=[];</span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">const day = date.getDate();</span><br><span class="line"></span><br><span class="line">  res.render(&quot;list&quot;, &#123;listTitle: day, newListItems: items&#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/&quot;, function(req, res)&#123;</span><br><span class="line"></span><br><span class="line">  const item = req.body.newItem;</span><br><span class="line"></span><br><span class="line">  if (req.body.list === &quot;Work&quot;) &#123;</span><br><span class="line">    workItems.push(item);</span><br><span class="line">    res.redirect(&quot;/work&quot;);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    items.push(item);</span><br><span class="line">    res.redirect(&quot;/&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/work&quot;, function(req,res)&#123;</span><br><span class="line">  res.render(&quot;list&quot;, &#123;listTitle: &quot;Work List&quot;, newListItems: workItems&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/about&quot;, function(req, res)&#123;</span><br><span class="line">  res.render(&quot;about&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(3000, function() &#123;</span><br><span class="line">  console.log(&quot;Server started on port 3000&quot;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>about.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;header&quot;) -%&gt;</span><br><span class="line">&lt;h2&gt;This is the about page&lt;/h2&gt;</span><br><span class="line">&lt;p&gt;關於內文&lt;/p&gt;</span><br><span class="line">&lt;%- include(&quot;footer&quot;) -%&gt;</span><br></pre></td></tr></table></figure>
<p><strong>header.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">  &lt;title&gt;To Do List&lt;/title&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;css/styles.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>footer.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;footer&gt;</span><br><span class="line">  Copyright 2018 The App Brewery</span><br><span class="line">&lt;/footer&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p><strong>list.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;header&quot;) -%&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot; id=&quot;heading&quot;&gt;</span><br><span class="line">    &lt;h1&gt; &lt;%= listTitle %&gt; &lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;% for (let i=0; i&lt;newListItems.length; i++) &#123; %&gt;</span><br><span class="line">      &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot;&gt;</span><br><span class="line">        &lt;p&gt;&lt;%=  newListItems[i]  %&gt;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;% &#125; %&gt;</span><br><span class="line">      &lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot; name=&quot;list&quot;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;%- include(&quot;footer&quot;) -%&gt;</span><br></pre></td></tr></table></figure>
<p><strong>date.js</strong>(後續會刪除,把焦點放在連接資料庫)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">exports.getDate = function() &#123;</span><br><span class="line">  const today = new Date();</span><br><span class="line">  const options = &#123;</span><br><span class="line">    weekday: &quot;long&quot;,</span><br><span class="line">    day: &quot;numeric&quot;,</span><br><span class="line">    month: &quot;long&quot;</span><br><span class="line">  &#125;;</span><br><span class="line">  return today.toLocaleDateString(&quot;en-US&quot;, options);</span><br><span class="line">&#125;;</span><br><span class="line">exports.getDay = function () &#123;</span><br><span class="line">  const today = new Date();</span><br><span class="line">  const options = &#123;</span><br><span class="line">    weekday: &quot;long&quot;</span><br><span class="line">  &#125;;</span><br><span class="line">  return today.toLocaleDateString(&quot;en-US&quot;, options);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>style.css</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">html &#123;</span><br><span class="line">  background-color: #E4E9FD;</span><br><span class="line">  background-image: -webkit-linear-gradient(65deg, #A683E3 50%, #E4E9FD 50%);</span><br><span class="line">  min-height: 1000px;</span><br><span class="line">  font-family: &#x27;helvetica neue&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">h1 &#123;</span><br><span class="line">  color: #fff;</span><br><span class="line">  padding: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box &#123;</span><br><span class="line">  max-width: 400px;</span><br><span class="line">  margin: 50px auto;</span><br><span class="line">  background: white;</span><br><span class="line">  border-radius: 5px;</span><br><span class="line">  box-shadow: 5px 5px 15px -5px rgba(0, 0, 0, 0.3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#heading &#123;</span><br><span class="line">  background-color: #A683E3;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.item &#123;</span><br><span class="line">  min-height: 70px;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  border-bottom: 1px solid #F1F1F1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.item:last-child &#123;</span><br><span class="line">  border-bottom: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">input:checked+p &#123;</span><br><span class="line">  text-decoration: line-through;</span><br><span class="line">  text-decoration-color: #A683E3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">input[type=&quot;checkbox&quot;] &#123;</span><br><span class="line">  margin: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">p &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 20px;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  font-weight: 200;</span><br><span class="line">  color: #00204a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">form &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  margin-left: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">button &#123;</span><br><span class="line">  min-height: 50px;</span><br><span class="line">  width: 50px;</span><br><span class="line">  border-radius: 50%;</span><br><span class="line">  border-color: transparent;</span><br><span class="line">  background-color: #A683E3;</span><br><span class="line">  color: #fff;</span><br><span class="line">  font-size: 30px;</span><br><span class="line">  padding-bottom: 6px;</span><br><span class="line">  border-width: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">input[type=&quot;text&quot;] &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  height: 60px;</span><br><span class="line">  top: 10px;</span><br><span class="line">  border: none;</span><br><span class="line">  background: transparent;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  font-weight: 200;</span><br><span class="line">  width: 313px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">input[type=&quot;text&quot;]:focus &#123;</span><br><span class="line">  outline: none;</span><br><span class="line">  box-shadow: inset 0 -3px 0 0 #A683E3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">::placeholder &#123;</span><br><span class="line">  color: grey;</span><br><span class="line">  opacity: 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">footer &#123;</span><br><span class="line">  color: white;</span><br><span class="line">  color: rgba(0, 0, 0, 0.5);</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="把node-module的部分補足"><a href="#把node-module的部分補足" class="headerlink" title="把node module的部分補足"></a>把node module的部分補足</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install </span><br></pre></td></tr></table></figure>

<h3 id="找到儲存資料的程式碼-並使用MongoDB-Mongoose取代"><a href="#找到儲存資料的程式碼-並使用MongoDB-Mongoose取代" class="headerlink" title="找到儲存資料的程式碼,並使用MongoDB,Mongoose取代"></a>找到儲存資料的程式碼,並使用MongoDB,Mongoose取代</h3><p><strong>app.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const date = require(__dirname + &quot;/date.js&quot;); //後續會刪除,把焦點放在套入資料庫</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.set(&#x27;view engine&#x27;, &#x27;ejs&#x27;);</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended: true&#125;));</span><br><span class="line">app.use(express.static(&quot;public&quot;));</span><br><span class="line"></span><br><span class="line">const items=[&quot;Buy food&quot;,&quot;Cook Food&quot;,&quot;Eat Food&quot;]; ///即將刪除的部分///</span><br><span class="line">const workItems=[]; ///即將刪除的部分///</span><br><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">const day = date.getDate();//後續會刪除,把焦點放在套入資料庫</span><br><span class="line"></span><br><span class="line">  res.render(&quot;list&quot;, &#123;listTitle: day, newListItems: items&#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/&quot;, function(req, res)&#123;</span><br><span class="line"></span><br><span class="line">  const item = req.body.newItem;</span><br><span class="line"></span><br><span class="line">  if (req.body.list === &quot;Work&quot;) &#123;</span><br><span class="line">    workItems.push(item);</span><br><span class="line">    res.redirect(&quot;/work&quot;);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    items.push(item);</span><br><span class="line">    res.redirect(&quot;/&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/work&quot;, function(req,res)&#123;</span><br><span class="line">  res.render(&quot;list&quot;, &#123;listTitle: &quot;Work List&quot;, newListItems: workItems&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/about&quot;, function(req, res)&#123;</span><br><span class="line">  res.render(&quot;about&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(3000, function() &#123;</span><br><span class="line">  console.log(&quot;Server started on port 3000&quot;,&#123; useNewUrlParser: true &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="安裝Mongoose"><a href="#安裝Mongoose" class="headerlink" title="安裝Mongoose"></a>安裝Mongoose</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mongoose</span><br></pre></td></tr></table></figure>

<p><strong>app.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">const mongoose=require(&quot;mongoose&quot;); //導入</span><br><span class="line">mongoose.connect(&quot;mongodb://localhost:27017/todolistDB&quot;);</span><br><span class="line">//用來連結mongoose的todolsitDB資料庫</span><br><span class="line">const itemSchema =&#123; //資料形式</span><br><span class="line">  name:String</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const itemSchema=new.mongoose.Schema(&#123;  //另一種寫法</span><br><span class="line">    name:String</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const Item = mongoose.model(&quot;Item&quot;,itemsSchema);//collection名稱:Item</span><br><span class="line">//const Item的I必須要大寫開頭,collection名稱(Item)必須為單數,因為資料庫會自動轉為複數</span><br><span class="line"></span><br><span class="line">const item1 = new Item(&#123;</span><br><span class="line">  name:&quot;welcome to todolist&quot;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const item2 =new Item(&#123;</span><br><span class="line">  name:&quot;hit the plus button to add a new item&quot;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const item3= new Item(&#123;</span><br><span class="line"> name:&quot;hit this to delete an item &quot;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const defaultItems=[item1,item2,item3];   //insertMany要以array的形式來呈現</span><br><span class="line"></span><br><span class="line">Item.insertMany(defaultItems,function(err)&#123;  //insertMany要以array的形式來呈現</span><br><span class="line">  if(err)&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    console.log(&quot;Successfully saved our default items to DB&quot;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


<h3 id="Rndering-Database-items-in-the-ToDoList-App"><a href="#Rndering-Database-items-in-the-ToDoList-App" class="headerlink" title="Rndering Database items in the ToDoList App"></a>Rndering Database items in the ToDoList App</h3><h3 id="從資料庫讀取資料並跟app-get做結合"><a href="#從資料庫讀取資料並跟app-get做結合" class="headerlink" title="從資料庫讀取資料並跟app.get做結合"></a>從資料庫讀取資料並跟app.get做結合</h3><p>app.js頁面的app.get部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  Item.find(&#123;&#125;, function(err, itemFound) &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">      console.log(err);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      res.render(&quot;list&quot;, &#123;</span><br><span class="line">        listTitle: &quot;Today&quot;,</span><br><span class="line">        newListItems: itemFound </span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>list.ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;header&quot;) -%&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot; id=&quot;heading&quot;&gt;</span><br><span class="line">    &lt;h1&gt; &lt;%= listTitle %&gt; &lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;% newListItems.forEach(function(item)&#123; %&gt;  //改為使用array.forEach()</span><br><span class="line">      &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot;&gt;</span><br><span class="line">        &lt;p&gt;&lt;%=  item.name  %&gt;&lt;/p&gt;</span><br><span class="line">    /////因為資料庫的collection是一個array,array裡面有三個javascript object,直接在這裡增加.name,就可以讀取到每一個object的name的值</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;% &#125;) %&gt;</span><br><span class="line"></span><br><span class="line">      &lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot; name=&quot;list&quot;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- include(&quot;footer&quot;) -%&gt;</span><br></pre></td></tr></table></figure>

<h3 id="解決每次打開伺服器預設的資料就會再增加到資料庫裏面的問題"><a href="#解決每次打開伺服器預設的資料就會再增加到資料庫裏面的問題" class="headerlink" title="解決每次打開伺服器預設的資料就會再增加到資料庫裏面的問題"></a>解決每次打開伺服器預設的資料就會再增加到資料庫裏面的問題</h3><p>把資料庫清空( 使用db.dropDatabase() )</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  Item.find(&#123;&#125;, function(err, itemFound) &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">      console.log(err);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      console.log(itemFound) /////會顯示[]</span><br><span class="line">      res.render(&quot;list&quot;, &#123;</span><br><span class="line">        listTitle: &quot;Today&quot;,</span><br><span class="line">        newListItems: itemFound </span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>app.get</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  Item.find(&#123;&#125;, function(err, itemFound) &#123;</span><br><span class="line">    if (itemFound.length===0) &#123; //假設collection是空的</span><br><span class="line">      Item.insertMany(defaultItems,function(err)&#123;</span><br><span class="line">        if(err)&#123;</span><br><span class="line">          console.log(err);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">          console.log(&quot;Successfully saved our default items to DB&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      res.redirect(&quot;/&quot;); //重新導向首頁,會跳過if部分的程式碼執行else的res.render</span><br><span class="line">    &#125; else &#123;</span><br><span class="line"></span><br><span class="line">      res.render(&quot;list&quot;, &#123;listTitle: &quot;Today&quot;,newListItems: itemFound&#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Adding-New-Items-to-out-ToDoList-Database"><a href="#Adding-New-Items-to-out-ToDoList-Database" class="headerlink" title="Adding New Items to out ToDoList Database"></a>Adding New Items to out ToDoList Database</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  const item = req.body.newItem;</span><br><span class="line"></span><br><span class="line">  if (req.body.list === &quot;Work&quot;) &#123; //移除//</span><br><span class="line">    workItems.push(item); //移除//</span><br><span class="line">    res.redirect(&quot;/work&quot;);  //移除//</span><br><span class="line">  &#125; else &#123;                 //移除//</span><br><span class="line">    items.push(item);       //移除//</span><br><span class="line">    res.redirect(&quot;/&quot;);      //移除//</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>改為</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  const itemName = req.body.newItem;</span><br><span class="line">  const item = new Item(&#123; </span><br><span class="line">    name: itemName</span><br><span class="line">  &#125;)</span><br><span class="line">  item.save();</span><br><span class="line">  res.redirect(&quot;/&quot;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Deleting-items-from-our-ToDoList"><a href="#Deleting-items-from-our-ToDoList" class="headerlink" title="Deleting items from our ToDoList"></a>Deleting items from our ToDoList</h3><p>在checkbox的部分加入form</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;header&quot;) -%&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot; id=&quot;heading&quot;&gt;</span><br><span class="line">    &lt;h1&gt; &lt;%= listTitle %&gt; &lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;% newListItems.forEach(function(item)&#123; %&gt;</span><br><span class="line">      &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;form&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot;&gt;</span><br><span class="line">        &lt;p&gt;&lt;%=  item.name  %&gt;&lt;/p&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;% &#125;) %&gt;</span><br><span class="line"></span><br><span class="line">      &lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot; name=&quot;list&quot;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- include(&quot;footer&quot;) -%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>此時發現網頁的CSS的部分checkbox的部分出現置中效果,到style.css確認,確認到有段CSS程式碼套用所有的form上面(本來只有一個form,新增一個之後變成兩個)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">form &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  margin-left: 20px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同時也發現到,本來的form有個class:”item”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">   &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">   &lt;button type=&quot;submit&quot; name=&quot;list&quot;&gt;+&lt;/button&gt;</span><br><span class="line"> &lt;/form&gt;</span><br></pre></td></tr></table></figure>


<p>解決:</p>
<p>把套用在form的selector改為以下,這樣原來的效果就會只套用在原來的form,不會影響到我們新增的form</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">form.item &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  margin-left: 20px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;header&quot;) -%&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot; id=&quot;heading&quot;&gt;</span><br><span class="line">    &lt;h1&gt; &lt;%= listTitle %&gt; &lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;% newListItems.forEach(function(item)&#123; %&gt;</span><br><span class="line">      &lt;form action=&quot;/delete&quot; method=&quot;post&quot;&gt;  //這裡的route負責刪除物件</span><br><span class="line">      &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot;&gt;</span><br><span class="line">        &lt;p&gt;&lt;%=  item.name  %&gt;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">      &lt;% &#125;) %&gt;</span><br><span class="line"></span><br><span class="line">      &lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt; //這裡的route負責新增item</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot; name=&quot;list&quot;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- include(&quot;footer&quot;) -%&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/delete&quot;,function(req,res)&#123;  </span><br><span class="line">   console.log(req.body)    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>這裡我們注意到重新啟動伺服器,並且到&#x2F;delete也沒什麼反應,沒有console.log的內容,新增item部分的form,因為button有一個submit的屬性,因此app.post的部分可以使用req.body收到使用者鍵入的訊息<br>What we want is whenever we click a checkbox we just want it to be able to delete that item.The action has to happen when we check the checkbox.<strong>How can we get the form to submit when the check box is checked?</strong></p>
<p><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC28%E7%AF%80checkbox%E5%88%AA%E9%99%A4%E7%89%A9%E4%BB%B6%E7%A4%BA%E6%84%8F%E5%9C%96.png" alt="網頁開發28節checkbox刪除物件示意圖.png"></p>
<p>解決:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;header&quot;) -%&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot; id=&quot;heading&quot;&gt;</span><br><span class="line">    &lt;h1&gt; &lt;%= listTitle %&gt; &lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;% newListItems.forEach(function(item)&#123; %&gt;</span><br><span class="line">      &lt;form action=&quot;/delete&quot; method=&quot;post&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot; name =&quot;checkbox&quot; onchange=&quot;this.form.submit()&quot;&gt;///新增程式碼</span><br><span class="line">        &lt;p&gt;&lt;%=  item.name  %&gt;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">      &lt;% &#125;) %&gt;</span><br><span class="line"></span><br><span class="line">      &lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot; name=&quot;list&quot;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- include(&quot;footer&quot;) -%&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/delete&quot;,function(req,res)&#123;  </span><br><span class="line">   console.log(req.body)    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>In addition to having a type, it is now going to have a onChange attribute.And also means when the checkbox is changed,so from checked to unchecked,unchecked to checked,then we are going to run this line of Javascript code which will take the current form that the input is inside,and is going to submit it to make the post request to our delete route.</p>
<p>此時重整網頁,並勾選checkbox</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">終端機顯示:</span><br><span class="line">&#123; checkbox: &#x27;on&#x27; &#125;</span><br></pre></td></tr></table></figure>

<p>再修正</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/delete&quot;,function(req,res)&#123;  </span><br><span class="line">   console.log(req.body.checkbox)    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;header&quot;) -%&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot; id=&quot;heading&quot;&gt;</span><br><span class="line">    &lt;h1&gt; &lt;%= listTitle %&gt; &lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;% newListItems.forEach(function(item)&#123; %&gt;</span><br><span class="line">      &lt;form action=&quot;/delete&quot; method=&quot;post&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot; name=&quot;checkbox&quot; value=&quot;&lt;%=item._id %&gt;&quot; onchange=&quot;this.form.submit()&quot;&gt;</span><br><span class="line">        //加入EJS,取得點擊物件的id(在資料庫)</span><br><span class="line">        &lt;p&gt;&lt;%=  item.name  %&gt;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">      &lt;% &#125;) %&gt;</span><br><span class="line"></span><br><span class="line">      &lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot; name=&quot;list&quot;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- include(&quot;footer&quot;) -%&gt;</span><br><span class="line"></span><br><span class="line">顯示:</span><br><span class="line">62568b4d5df174388e99ce49</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/delete&quot;,function(req,res)&#123;</span><br><span class="line">  const checkedItemid= req.body.checkbox;</span><br><span class="line">  Item.findByIdAndRemove(checkedItemid,function(err)&#123;</span><br><span class="line">    if(!err)&#123;</span><br><span class="line">      console.log(&quot;Successfully deleted item&quot;);</span><br><span class="line">      res.redirect(&quot;/&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>問題點這邊沒有解決:當所有物件被刪除的時候,網頁redirect到(“&#x2F;“),因為以下程式碼,又會重新把預設的三個物件又加入collection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  Item.find(&#123;&#125;, function(err, itemFound) &#123;</span><br><span class="line">    if (itemFound.length===0) &#123;</span><br><span class="line">      Item.insertMany(defaultItems,function(err)&#123;</span><br><span class="line">        if(err)&#123;</span><br><span class="line">          console.log(err);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">          console.log(&quot;Successfully saved our default items to DB&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      res.redirect(&quot;/&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line"></span><br><span class="line">      res.render(&quot;list&quot;, &#123;listTitle: &quot;Today&quot;,newListItems: itemFound&#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Creating-Custom-List-Using-Express-Route-Parameter"><a href="#Creating-Custom-List-Using-Express-Route-Parameter" class="headerlink" title="Creating Custom List Using Express Route Parameter"></a>Creating Custom List Using Express Route Parameter</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/:customListName&quot;,function(req,res)&#123;</span><br><span class="line">const customListName= req.params.customListName</span><br><span class="line">console.log(customListName)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">網址列:http://localhost:3000/123</span><br><span class="line">終端機顯示:123</span><br></pre></td></tr></table></figure>

<p>建立一個依照輸入的網址後段文字建立的collection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const itemsSchema = &#123;</span><br><span class="line">  name: String</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const listSchema=&#123;</span><br><span class="line">  name:String,</span><br><span class="line">  items:[itemsSchema]</span><br><span class="line">&#125;</span><br><span class="line">const List=mongoose.model(&quot;list&quot;,listSchema) //list必須為單數</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/:customListName&quot;,function(req,res)&#123;</span><br><span class="line">const customListName= req.params.customListName</span><br><span class="line">const list =new List(&#123;</span><br><span class="line">  name:customListName,</span><br><span class="line">  items:defaultItems</span><br><span class="line">&#125;);</span><br><span class="line">list.save()</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">網址列輸入:http://localhost:3000/Jeremy ,使用db.lists.find(),會顯示:</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;6256d00dcf2f1f6e71965a36&quot;), &quot;name&quot; : &quot;Jeremy&quot;, &quot;items&quot; : [ &#123; &quot;name&quot; : &quot;welcome to todolist&quot;, &quot;_id&quot; : ObjectId(&quot;6256cf1ecf2f1f6e71965a29&quot;) &#125;, &#123; &quot;name&quot; : &quot;hit the plus button to add a new item&quot;, &quot;_id&quot; : ObjectId(&quot;6256cf1ecf2f1f6e71965a2a&quot;) &#125;, &#123; &quot;name&quot; : &quot;&lt;--hit this to delete an item &quot;, &quot;_id&quot; : ObjectId(&quot;6256cf1ecf2f1f6e71965a2b&quot;) &#125; ], &quot;__v&quot; : 0 &#125;</span><br></pre></td></tr></table></figure>

<h3 id="問題-每次使用者登入都會把資料再加入一次"><a href="#問題-每次使用者登入都會把資料再加入一次" class="headerlink" title="問題:每次使用者登入都會把資料再加入一次"></a>問題:每次使用者登入都會把資料再加入一次</h3><p>Item.find({}, function(err, itemFound) {}:itemFound是一個array<br>List.findOne({ name: customListName}, function(err, foundList):foundlist是一個object</p>
<p>改為</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/:customListName&quot;, function(req, res) &#123;</span><br><span class="line">  const customListName = req.params.customListName; //取得自行輸入的網址</span><br><span class="line">  List.findOne(&#123;name: customListName&#125;, function(err, foundList) &#123;</span><br><span class="line">    if (!err) &#123; </span><br><span class="line">      if (!foundList) &#123;  //如果不存在,代表第一次到這個網頁</span><br><span class="line">        const list = new List(&#123;</span><br><span class="line">          name: customListName,</span><br><span class="line">          items: defaultItems</span><br><span class="line">        &#125;);</span><br><span class="line">        list.save()</span><br><span class="line">        res.redirect(&quot;/&quot;+customListName)</span><br><span class="line">      &#125;else&#123;   //已經創建過,資料庫有資料</span><br><span class="line">        res.render(&quot;list&quot;, &#123;listTitle:foundList.name,newListItems: foundList.items&#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Adding-New-Items-to-the-Custom-List"><a href="#Adding-New-Items-to-the-Custom-List" class="headerlink" title="Adding New Items to the Custom List"></a>Adding New Items to the Custom List</h3><p>會遇到一個問題當我們到localhost:3000&#x2F;自行輸入的文字,並進到該網頁,點擊新增item時,會跳回去(“&#x2F;“),因為:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt; //跟(&quot;/&quot;)呼應</span><br><span class="line">      &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">      &lt;button type=&quot;submit&quot; name=&quot;list&quot; &gt;+&lt;/button&gt;</span><br><span class="line">    &lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p>所以我們必須判別按鈕的submit是從哪一個網頁網址發出的</p>
<p>form程式碼改為</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt; //跟(&quot;/&quot;)呼應</span><br><span class="line">       &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">       &lt;button type=&quot;submit&quot; name=&quot;list&quot; value=&quot;&lt;%=listTitle %&gt;&quot;&gt;+&lt;/button&gt;//新增</span><br><span class="line">     &lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>在app.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const listName = req.body.list; //這個會是&lt;%=listTitle %&gt;的值</span><br></pre></td></tr></table></figure>

<p>app.post(“&#x2F;“, function(req, res) {</p>
<p>  const itemName &#x3D; req.body.newItem; &#x2F;&#x2F;輸入的資料<br>  const listName &#x3D; req.body.list;    &#x2F;&#x2F;網址列最後自行輸入部分<br>  const item &#x3D; new Item({<br>    name: itemName<br>  })<br>  if (listName &#x3D;&#x3D;&#x3D; “Today”) { &#x2F;&#x2F;確認是在首頁還是使用者自己開的網頁<br>    item.save();<br>    res.redirect(“&#x2F;“)<br>  } else { &#x2F;&#x2F;不是在首頁<br>    List.findOne({name: listName},function(err, foundList) {<br>          foundList.items.push(item);&#x2F;&#x2F;foundLlist是一個object,items是一個array<br>          console.log(foundList)<br>          foundList.save()<br>          &#x2F;&#x2F;更動子檔案,對父檔案進行save()是能夠進行儲存的,且從資料庫讀取資料並更動,此時使用save(),可以進行對資料的更新</p>
<pre><code>      res.redirect(&quot;/&quot; + listName)
    &#125;)
  &#125;
</code></pre>
<p>});</p>
<h3 id="Revisiting-Lodash-and-Deleting-Items-From-Custom-ToDoList"><a href="#Revisiting-Lodash-and-Deleting-Items-From-Custom-ToDoList" class="headerlink" title="Revisiting Lodash and Deleting Items From Custom ToDoList"></a>Revisiting Lodash and Deleting Items From Custom ToDoList</h3><p><strong>為了能夠刪除不想要的todolist,我們必須確認checkbox,checked以及unchecked的動作是從哪個頁面來的</strong></p>
<p>list.ejs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;header&quot;) -%&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot; id=&quot;heading&quot;&gt;</span><br><span class="line">    &lt;h1&gt; &lt;%= listTitle %&gt; &lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;% newListItems.forEach(function(item)&#123; %&gt;</span><br><span class="line">      &lt;form action=&quot;/delete&quot; method=&quot;post&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot; name=&quot;checkbox&quot; value=&quot;&lt;%=item._id %&gt;&quot; onchange=&quot;this.form.submit()&quot;&gt;</span><br><span class="line">        &lt;p&gt;&lt;%=  item.name  %&gt;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;listName&quot; value=&quot;&lt;% listTitle%&gt;&quot;&gt;&lt;/input&gt; </span><br><span class="line">      ///新增一行具有hidden性質的input,用來辨別checkbox的操作是從哪個頁面</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">      &lt;% &#125;) %&gt;</span><br><span class="line"></span><br><span class="line">      &lt;form class=&quot;item&quot; action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;newItem&quot; placeholder=&quot;New Item&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot; name=&quot;list&quot; value=&quot;&lt;%=listTitle %&gt;&quot;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- include(&quot;footer&quot;) -%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/delete&quot;, function(req, res) &#123;</span><br><span class="line">  const checkedItemid = req.body.checkbox;</span><br><span class="line">  const listName = req.body.listName  //確認從什麼頁面收到的checkbox指令</span><br><span class="line">  if(listName===&quot;Today&quot;)&#123;   </span><br><span class="line">    Item.findByIdAndRemove(checkedItemid, function(err) &#123;</span><br><span class="line">      if (!err) &#123;</span><br><span class="line">        res.redirect(&quot;/&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    List.findOneAndUpdate(&#123;name:listName&#125;,&#123;$pull:&#123;items:&#123;_id:checkedItemid&#125;&#125;&#125;,function(err,foundList)&#123;</span><br><span class="line">     if(!err)&#123;</span><br><span class="line">       res.redirect(&quot;/&quot;+listName);</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="解決網頁輸入大小寫問題"><a href="#解決網頁輸入大小寫問題" class="headerlink" title="解決網頁輸入大小寫問題"></a>解決網頁輸入大小寫問題</h3><p>在網址列最後輸入網址進入指定網址頁面時,todo與Todo會被分辨為兩個頁面並且建立兩筆資料</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i lodash</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const _ =require(&quot;lodash&quot;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">app.get(&quot;/:customListName&quot;, function(req, res) &#123;</span><br><span class="line">  const customListName = _.capitalize(req.params.customListName);</span><br><span class="line">  List.findOne(&#123;name: customListName&#125;, function(err, foundList) &#123;</span><br><span class="line">    if (!err) &#123;</span><br><span class="line">    </span><br><span class="line">      if (!foundList) &#123;</span><br><span class="line">        const list = new List(&#123;</span><br><span class="line">          name: customListName,</span><br><span class="line">          items: defaultItems</span><br><span class="line">        &#125;);</span><br><span class="line">        list.save()</span><br><span class="line">        res.redirect(&quot;/&quot; + customListName)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        res.render(&quot;list&quot;, &#123;</span><br><span class="line">          listTitle: foundList.name,</span><br><span class="line">          newListItems: foundList.items</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="解決資料庫會多出一筆資料"><a href="#解決資料庫會多出一筆資料" class="headerlink" title="解決資料庫會多出一筆資料"></a>解決資料庫會多出一筆資料</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  _id: ObjectId(&quot;62585c1a70410de2c743c3e7&quot;), //多出來的資料</span><br><span class="line">  name: &#x27;Favicon.ico&#x27;,</span><br><span class="line">  items: [</span><br><span class="line">    &#123;</span><br><span class="line">      name: &#x27;welcome to todolist&#x27;,</span><br><span class="line">      _id: ObjectId(&quot;62585c0670410de2c743c3e0&quot;)</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      name: &#x27;hit the plus button to add a new item&#x27;,</span><br><span class="line">      _id: ObjectId(&quot;62585c0670410de2c743c3e1&quot;)</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      name: &#x27;&lt;--hit this to delete an item &#x27;,</span><br><span class="line">      _id: ObjectId(&quot;62585c0670410de2c743c3e2&quot;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>在header.ejs改為</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">  &lt;title&gt;To Do List&lt;/title&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;css/styles.css&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;icon&quot; href=&quot;data:,&quot;&gt;////新增程式碼</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC28%E7%AF%80Favicon.ico%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95.png" alt="Favicon.icor解決辦法.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://razieldu.github.io">Jeremy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://razieldu.github.io/2022/04/11/Udemy-WebDevelopment-ch28-Put-Everything-Together/">https://razieldu.github.io/2022/04/11/Udemy-WebDevelopment-ch28-Put-Everything-Together/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/04/14/Udemy-WebDevelopment-ch29-Deploying-Your-Web-Application/"><img class="prev-cover" src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Ch29 Deploying Your Web Application</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/09/Udemy-WebDevelopment-ch27-Mongoose/"><img class="next-cover" src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Udemy Web Development Ch27 Mongoose</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jeremy</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">74</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Razieldu"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%88%E6%A1%88%E7%A8%8B%E5%BC%8F%E7%A2%BC"><span class="toc-number">1.</span> <span class="toc-text">專案程式碼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%8Anode-module%E7%9A%84%E9%83%A8%E5%88%86%E8%A3%9C%E8%B6%B3"><span class="toc-number">2.</span> <span class="toc-text">把node module的部分補足</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E5%84%B2%E5%AD%98%E8%B3%87%E6%96%99%E7%9A%84%E7%A8%8B%E5%BC%8F%E7%A2%BC-%E4%B8%A6%E4%BD%BF%E7%94%A8MongoDB-Mongoose%E5%8F%96%E4%BB%A3"><span class="toc-number">3.</span> <span class="toc-text">找到儲存資料的程式碼,並使用MongoDB,Mongoose取代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%9DMongoose"><span class="toc-number">4.</span> <span class="toc-text">安裝Mongoose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rndering-Database-items-in-the-ToDoList-App"><span class="toc-number">5.</span> <span class="toc-text">Rndering Database items in the ToDoList App</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%9E%E8%B3%87%E6%96%99%E5%BA%AB%E8%AE%80%E5%8F%96%E8%B3%87%E6%96%99%E4%B8%A6%E8%B7%9Fapp-get%E5%81%9A%E7%B5%90%E5%90%88"><span class="toc-number">6.</span> <span class="toc-text">從資料庫讀取資料並跟app.get做結合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B1%BA%E6%AF%8F%E6%AC%A1%E6%89%93%E9%96%8B%E4%BC%BA%E6%9C%8D%E5%99%A8%E9%A0%90%E8%A8%AD%E7%9A%84%E8%B3%87%E6%96%99%E5%B0%B1%E6%9C%83%E5%86%8D%E5%A2%9E%E5%8A%A0%E5%88%B0%E8%B3%87%E6%96%99%E5%BA%AB%E8%A3%8F%E9%9D%A2%E7%9A%84%E5%95%8F%E9%A1%8C"><span class="toc-number">7.</span> <span class="toc-text">解決每次打開伺服器預設的資料就會再增加到資料庫裏面的問題</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Adding-New-Items-to-out-ToDoList-Database"><span class="toc-number">8.</span> <span class="toc-text">Adding New Items to out ToDoList Database</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deleting-items-from-our-ToDoList"><span class="toc-number">9.</span> <span class="toc-text">Deleting items from our ToDoList</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-Custom-List-Using-Express-Route-Parameter"><span class="toc-number">10.</span> <span class="toc-text">Creating Custom List Using Express Route Parameter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%95%8F%E9%A1%8C-%E6%AF%8F%E6%AC%A1%E4%BD%BF%E7%94%A8%E8%80%85%E7%99%BB%E5%85%A5%E9%83%BD%E6%9C%83%E6%8A%8A%E8%B3%87%E6%96%99%E5%86%8D%E5%8A%A0%E5%85%A5%E4%B8%80%E6%AC%A1"><span class="toc-number">11.</span> <span class="toc-text">問題:每次使用者登入都會把資料再加入一次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Adding-New-Items-to-the-Custom-List"><span class="toc-number">12.</span> <span class="toc-text">Adding New Items to the Custom List</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Revisiting-Lodash-and-Deleting-Items-From-Custom-ToDoList"><span class="toc-number">13.</span> <span class="toc-text">Revisiting Lodash and Deleting Items From Custom ToDoList</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B1%BA%E7%B6%B2%E9%A0%81%E8%BC%B8%E5%85%A5%E5%A4%A7%E5%B0%8F%E5%AF%AB%E5%95%8F%E9%A1%8C"><span class="toc-number">14.</span> <span class="toc-text">解決網頁輸入大小寫問題</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B1%BA%E8%B3%87%E6%96%99%E5%BA%AB%E6%9C%83%E5%A4%9A%E5%87%BA%E4%B8%80%E7%AD%86%E8%B3%87%E6%96%99"><span class="toc-number">15.</span> <span class="toc-text">解決資料庫會多出一筆資料</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/05/Udemy-React-TheCompleteGuide-ch23-Next-JS/" title="Udemy-React-TheCompleteGuide ch22 React Authenticaton  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch22 React Authenticaton  "/></a><div class="content"><a class="title" href="/2022/08/05/Udemy-React-TheCompleteGuide-ch23-Next-JS/" title="Udemy-React-TheCompleteGuide ch22 React Authenticaton  ">Udemy-React-TheCompleteGuide ch22 React Authenticaton  </a><time datetime="2022-08-05T08:51:55.000Z" title="Created 2022-08-05 16:51:55">2022-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/24/Redux-VS-Redux-ToolKit/" title="Redux VS Redux-ToolKit"><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redux VS Redux-ToolKit"/></a><div class="content"><a class="title" href="/2022/07/24/Redux-VS-Redux-ToolKit/" title="Redux VS Redux-ToolKit">Redux VS Redux-ToolKit</a><time datetime="2022-07-24T04:43:06.000Z" title="Created 2022-07-24 12:43:06">2022-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/15/Udemy-React-TheCompleteGuide-ch22-React-Authentication/" title="Udemy-React-TheCompleteGuide ch22 React Authenticaton  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch22 React Authenticaton  "/></a><div class="content"><a class="title" href="/2022/07/15/Udemy-React-TheCompleteGuide-ch22-React-Authentication/" title="Udemy-React-TheCompleteGuide ch22 React Authenticaton  ">Udemy-React-TheCompleteGuide ch22 React Authenticaton  </a><time datetime="2022-07-15T07:47:55.000Z" title="Created 2022-07-15 15:47:55">2022-07-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/14/Udemy-React-TheCompleteGuide-ch21-React-Deploy/" title="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  "/></a><div class="content"><a class="title" href="/2022/07/14/Udemy-React-TheCompleteGuide-ch21-React-Deploy/" title="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  ">Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  </a><time datetime="2022-07-14T05:39:55.000Z" title="Created 2022-07-14 13:39:55">2022-07-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/06/Udemy-React-TheCompleteGuide-ch20-React-Router/" title="Udemy-React-TheCompleteGuide ch20 Muti Page SPA with React Router "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch20 Muti Page SPA with React Router "/></a><div class="content"><a class="title" href="/2022/07/06/Udemy-React-TheCompleteGuide-ch20-React-Router/" title="Udemy-React-TheCompleteGuide ch20 Muti Page SPA with React Router ">Udemy-React-TheCompleteGuide ch20 Muti Page SPA with React Router </a><time datetime="2022-07-06T11:28:55.000Z" title="Created 2022-07-06 19:28:55">2022-07-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Jeremy</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>