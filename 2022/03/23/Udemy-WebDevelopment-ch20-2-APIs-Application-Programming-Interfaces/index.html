<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Udemy Web Development Ch20-2 APIs Application Programming Interfaces | Jeremy's Blog</title><meta name="author" content="Jeremy"><meta name="copyright" content="Jeremy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="The Mailchimp API基本檔案設置 建立signup.html,success.html,failure.html,app.js,styles.css npm init npm install express,body-parser,request 在app.js 導入npm套件  使用hyper terminal 一次建立多個檔案12touch app.js success.html">
<meta property="og:type" content="article">
<meta property="og:title" content="Udemy Web Development Ch20-2 APIs Application Programming Interfaces">
<meta property="og:url" content="https://razieldu.github.io/2022/03/23/Udemy-WebDevelopment-ch20-2-APIs-Application-Programming-Interfaces/index.html">
<meta property="og:site_name" content="Jeremy&#39;s Blog">
<meta property="og:description" content="The Mailchimp API基本檔案設置 建立signup.html,success.html,failure.html,app.js,styles.css npm init npm install express,body-parser,request 在app.js 導入npm套件  使用hyper terminal 一次建立多個檔案12touch app.js success.html">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg">
<meta property="article:published_time" content="2022-03-22T16:20:52.000Z">
<meta property="article:modified_time" content="2022-04-28T04:50:29.820Z">
<meta property="article:author" content="Jeremy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://razieldu.github.io/2022/03/23/Udemy-WebDevelopment-ch20-2-APIs-Application-Programming-Interfaces/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Udemy Web Development Ch20-2 APIs Application Programming Interfaces',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-28 12:50:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">74</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jeremy's Blog</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Udemy Web Development Ch20-2 APIs Application Programming Interfaces</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-03-22T16:20:52.000Z" title="Created 2022-03-23 00:20:52">2022-03-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-04-28T04:50:29.820Z" title="Updated 2022-04-28 12:50:29">2022-04-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web-development/">Web development</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Udemy Web Development Ch20-2 APIs Application Programming Interfaces"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="The-Mailchimp-API"><a href="#The-Mailchimp-API" class="headerlink" title="The Mailchimp API"></a>The Mailchimp API</h3><h3 id="基本檔案設置"><a href="#基本檔案設置" class="headerlink" title="基本檔案設置"></a>基本檔案設置</h3><ol>
<li>建立signup.html,success.html,failure.html,app.js,styles.css</li>
<li>npm init</li>
<li>npm install express,body-parser,request</li>
<li>在app.js 導入npm套件</li>
</ol>
<h3 id="使用hyper-terminal-一次建立多個檔案"><a href="#使用hyper-terminal-一次建立多個檔案" class="headerlink" title="使用hyper terminal 一次建立多個檔案"></a>使用hyper terminal 一次建立多個檔案</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch app.js success.html failure.html signup.htm </span><br><span class="line">npm install exrpess body-parser request</span><br></pre></td></tr></table></figure>

<h3 id="複製bootstrap範本"><a href="#複製bootstrap範本" class="headerlink" title="複製bootstrap範本"></a>複製bootstrap範本</h3><p>前往bootstrap首頁,點擊example,選擇signin的範本,查看程式碼,同時在察看程式碼頁面點擊css的link查看並複製相關CSS程式碼至style.css,複製所有程式碼至signup.html,導入bootstrap CDN,修改CSS導入的路徑,設置圖片路徑,導入signup頁面圖片</p>
<h3 id="在localhost-3000-設置伺服器"><a href="#在localhost-3000-設置伺服器" class="headerlink" title="在localhost:3000 設置伺服器"></a>在localhost:3000 設置伺服器</h3><p>app.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line"></span><br><span class="line">const request = require(&quot;request&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;,function(req,res)&#123;</span><br><span class="line">  res.sendFile(__dirname+&quot;/signup.html&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(&quot;3000&quot;,function()&#123;</span><br><span class="line">console.log(&quot;Server is  running on port 3000&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>此時出現一個問題:網頁只有顯示基本的HTML架構</p>
<p><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC20%E7%AB%A0%E7%AF%80ressendfile%E5%A4%B1%E6%95%97.png" alt="網頁開發20章節ressendfile失敗.png"></p>
<p>We look inside this website ,we got the Bootstrap style sheet from a remote location,but our custom style sheet is local,so this is basically a static page in our local file system that we are trying to pull up, and it is exactly the same story with our image.<br><strong>In order for our server to serve up static files such as CSS and images ,then we need to use a special function of Express and that is somthing call static</strong></p>
<p>在Newsletter-Signup資料夾建立一個public資料夾,在public資料夾建立image以及css123資料夾,image以及css檔案分別移入</p>
<p>By using app.use(express.static),providing the path of our static files,then we should be able to refer to these static files by a relative URL,and that is relative to the public folder,imagining that we are current inside the public folder ,in order to get ot our style sheet  </p>
<p>app.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(&quot;public&quot;));</span><br></pre></td></tr></table></figure>

<p>signup.html</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">css路徑改為:css123/styles123.css</span><br><span class="line">圖片路徑改為:image/signupimage.png(跟原來是一樣的)</span><br></pre></td></tr></table></figure>

<h3 id="Posting-Data-to-Mailchimp’s-Server-via-their-API"><a href="#Posting-Data-to-Mailchimp’s-Server-via-their-API" class="headerlink" title="Posting Data to Mailchimp’s Server via their API"></a>Posting Data to Mailchimp’s Server via their API</h3><p><a target="_blank" rel="noopener" href="https://mailchimp.com/">https://mailchimp.com/</a> mailchimp首頁</p>
<ol>
<li><p>註冊免費帳號</p>
</li>
<li><p>前往 <a target="_blank" rel="noopener" href="https://mailchimp.com/developer/">https://mailchimp.com/developer/</a> mailchimp for developer</p>
</li>
<li><p>前往 <a target="_blank" rel="noopener" href="https://us14.admin.mailchimp.com/account/api/">https://us14.admin.mailchimp.com/account/api/</a> ,取得個人API KEY</p>
</li>
</ol>
<p>到mailchimp個人頁面,點擊audience,點擊all contact,點擊settings,點擊audience name and default,取得個人audience id</p>
<p>更新版本(mailchimp文件有更新)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const request = require(&quot;request&quot;);</span><br><span class="line">const mailchimp = require(&quot;@mailchimp/mailchimp_marketing&quot;);</span><br><span class="line"></span><br><span class="line">mailchimp.setConfig(&#123;</span><br><span class="line">  apiKey: &quot;2fde44fd73cf51f578dbbaa03c9ef6a4&quot;,</span><br><span class="line">  server: &quot;us14&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">async function run() &#123;</span><br><span class="line">  const response = await mailchimp.ping.get();</span><br><span class="line">  console.log(response);</span><br><span class="line">&#125;</span><br><span class="line">run();</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;))</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:true&#125;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;,function(req,res)&#123;</span><br><span class="line">  res.sendFile(__dirname+&quot;/signup.html&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.post(&quot;/&quot;,function(req,res)&#123;</span><br><span class="line">  var firstName = req.body.姓氏;</span><br><span class="line">  var lastName = req.body.名字;</span><br><span class="line">  var emailAddress= req.body.email;</span><br><span class="line">  const listId = &quot;a500e5aabe&quot;;</span><br><span class="line">  const subscribingUser = &#123;</span><br><span class="line">    firstName: firstName,</span><br><span class="line">    lastName: lastName,</span><br><span class="line">    email:emailAddress</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  async function run() &#123;</span><br><span class="line">    const response = await mailchimp.lists.addListMember(listId, &#123;</span><br><span class="line">      email_address: subscribingUser.email,</span><br><span class="line">      status: &quot;subscribed&quot;,</span><br><span class="line">      merge_fields: &#123;</span><br><span class="line">        FNAME: subscribingUser.firstName,</span><br><span class="line">        LNAME: subscribingUser.lastName</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    console.log(</span><br><span class="line">      `Successfully added contact as an audience member. The contact&#x27;s id is $&#123;</span><br><span class="line">        response.id</span><br><span class="line">      &#125;.`</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  run();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(&quot;3000&quot;,function()&#123;</span><br><span class="line">console.log(&quot;Server is  running on port 3000&quot;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>成功把輸入的資料導入mailchimp</p>
<h3 id="Adding-Success-and-Failure-Pages"><a href="#Adding-Success-and-Failure-Pages" class="headerlink" title="Adding Success and Failure Pages"></a>Adding Success and Failure Pages</h3><p>success.html</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Success&lt;/title&gt;</span><br><span class="line">    &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; integrity=&quot;sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3&quot; crossorigin=&quot;anonymous&quot;&gt;</span><br><span class="line">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot; integrity=&quot;sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;p-5 mb-4 bg-light rounded-3&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;container-fluid py-5&quot;&gt;</span><br><span class="line">        &lt;h1 class=&quot;display-5 fw-bold&quot;&gt;太棒了!&lt;/h1&gt;</span><br><span class="line">        &lt;p class=&quot;col-md-8 fs-4&quot;&gt;您已經註冊成功,並加入會員&lt;/p&gt;</span><br><span class="line">      </span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>failure.html</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Failure&lt;/title&gt;</span><br><span class="line">    &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; integrity=&quot;sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3&quot; crossorigin=&quot;anonymous&quot;&gt;</span><br><span class="line">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot; integrity=&quot;sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;p-5 mb-4 bg-light rounded-3&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;container-fluid py-5&quot;&gt;</span><br><span class="line">        &lt;h1 class=&quot;display-5 fw-bold&quot;&gt;糟糕!&lt;/h1&gt;</span><br><span class="line">        &lt;p class=&quot;col-md-8 fs-4&quot;&gt;註冊時出現問題,請稍後再進行嘗試,或是聯繫技術人員&lt;/p&gt;</span><br><span class="line">        &lt;form action=&quot;/failure&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;button class=&quot;btn btn-primary btn-lg&quot;  type=&quot;submit&quot; &gt;回到註冊頁面&lt;/button&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>button使用submit,使用form action:”&#x2F;failure” method:post,並且在app.js新增代碼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.post(&quot;/failure&quot;,function(req,res)&#123;</span><br><span class="line">  res.redirect(&quot;/&quot;)  //從failure頁面接收的res並且重新引導到signup.html</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>signup.html</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;author&quot; content=&quot;Mark Otto, Jacob Thornton, and Bootstrap contributors&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;generator&quot; content=&quot;Hugo 0.88.1&quot;&gt;</span><br><span class="line">  &lt;title&gt;全球趨勢網&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">  &lt;link rel=&quot;canonical&quot; href=&quot;https://getbootstrap.com/docs/5.1/examples/sign-in/&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- font style--&gt;</span><br><span class="line">  &lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.googleapis.com&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.gstatic.com&quot; crossorigin&gt;</span><br><span class="line">  &lt;link href=&quot;https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@700&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">  &lt;!-- Bootstrap core CSS --&gt;</span><br><span class="line">  &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; integrity=&quot;sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3&quot; crossorigin=&quot;anonymous&quot;&gt;</span><br><span class="line">  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot; integrity=&quot;sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;!-- Favicons --&gt;</span><br><span class="line">  &lt;link rel=&quot;apple-touch-icon&quot; href=&quot;/docs/5.1/assets/img/favicons/apple-touch-icon.png&quot; sizes=&quot;180x180&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;icon&quot; href=&quot;/docs/5.1/assets/img/favicons/favicon-32x32.png&quot; sizes=&quot;32x32&quot; type=&quot;image/png&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;icon&quot; href=&quot;/docs/5.1/assets/img/favicons/favicon-16x16.png&quot; sizes=&quot;16x16&quot; type=&quot;image/png&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;manifest&quot; href=&quot;/docs/5.1/assets/img/favicons/manifest.json&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;mask-icon&quot; href=&quot;/docs/5.1/assets/img/favicons/safari-pinned-tab.svg&quot; color=&quot;#7952b3&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;icon&quot; href=&quot;/docs/5.1/assets/img/favicons/favicon.ico&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;theme-color&quot; content=&quot;#7952b3&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    .bd-placeholder-img &#123;</span><br><span class="line">      font-size: 1.125rem;</span><br><span class="line">      text-anchor: middle;</span><br><span class="line">      -webkit-user-select: none;</span><br><span class="line">      -moz-user-select: none;</span><br><span class="line">      user-select: none;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @media (min-width: 768px) &#123;</span><br><span class="line">      .bd-placeholder-img-lg &#123;</span><br><span class="line">        font-size: 3.5rem;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;!-- Custom styles for this template --&gt;</span><br><span class="line">  &lt;link href=&quot;css123/styles123.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body class=&quot;text-center&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;main class=&quot;form-signin&quot;&gt;</span><br><span class="line">    &lt;form action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">      &lt;img class=&quot;mb-4&quot; src=&quot;image/signupimage.png&quot; alt=&quot;&quot; width=&quot;72&quot; height=&quot;57&quot;&gt;</span><br><span class="line">      &lt;h1 class=&quot;h3 mb-4 fw-bold&quot;&gt;註冊並掌握全球趨勢&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;form-floating&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; class=&quot;form-control top&quot; id=&quot;floatingPassword&quot; name=&quot;姓氏&quot; placeholder=&quot;姓氏&quot;&gt;</span><br><span class="line">        &lt;label for=&quot;floatingPassword&quot;&gt;姓氏&lt;/label&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;form-floating&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; class=&quot;form-control mid&quot; id=&quot;floatingPassword2&quot; name=&quot;名字&quot; placeholder=&quot;名字&quot;&gt;</span><br><span class="line">        &lt;label for=&quot;floatingPassword2&quot;&gt;名字&lt;/label&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;form-floating&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;email&quot; class=&quot;form-control bottom&quot; id=&quot;floatingInput&quot; name=&quot;email&quot; placeholder=&quot;name@example.com&quot;&gt;</span><br><span class="line">        &lt;label for=&quot;floatingInput&quot;&gt;Email address&lt;/label&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;button class=&quot;w-100 btn btn-lg btn-primary&quot; type=&quot;submit&quot;&gt;加入會員&lt;/button&gt;</span><br><span class="line">      &lt;p class=&quot;mt-5 mb-3 text-muted&quot;&gt;&amp;copy; 承修全球趨勢網2022&lt;/p&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/main&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="app-js-網友版本"><a href="#app-js-網友版本" class="headerlink" title="app.js(網友版本)"></a>app.js(網友版本)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const request = require(&quot;request&quot;);</span><br><span class="line">const mailchimp = require(&quot;@mailchimp/mailchimp_marketing&quot;);</span><br><span class="line"></span><br><span class="line">mailchimp.setConfig(&#123;</span><br><span class="line">  apiKey: &quot;2fde44fd73cf51f578dbbaa03c9ef6a4&quot;,</span><br><span class="line">  server: &quot;us14&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">async function run() &#123;</span><br><span class="line">  const response = await mailchimp.ping.get();</span><br><span class="line">  console.log(response);</span><br><span class="line">&#125;</span><br><span class="line">run();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;))</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:true&#125;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;,function(req,res)&#123;</span><br><span class="line">  res.sendFile(__dirname+&quot;/signup.html&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/failure&quot;,function(req,res)&#123;</span><br><span class="line">  res.redirect(&quot;/&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/&quot;,function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">  var firstName = req.body.姓氏;</span><br><span class="line">  var lastName = req.body.名字;</span><br><span class="line">  var emailAddress= req.body.email;</span><br><span class="line">  const listId = &quot;a500e5aabe&quot;;</span><br><span class="line">  const subscribingUser = &#123;</span><br><span class="line">    firstName: firstName,</span><br><span class="line">    lastName: lastName,</span><br><span class="line">    email:emailAddress</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  async function run() &#123;</span><br><span class="line">    const response = await mailchimp.lists.addListMember(listId, &#123;</span><br><span class="line">      email_address: subscribingUser.email,</span><br><span class="line">      status: &quot;subscribed&quot;,</span><br><span class="line">      merge_fields: &#123;</span><br><span class="line">        FNAME: subscribingUser.firstName,</span><br><span class="line">        LNAME: subscribingUser.lastName</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    res.sendFile(__dirname+&quot;/success.html&quot;);</span><br><span class="line">    console.log(</span><br><span class="line">      `Successfully added contact as an audience member. The contact&#x27;s id is $&#123;</span><br><span class="line">        response.id</span><br><span class="line">      &#125;.`</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  run().catch(e =&gt; res.sendFile(__dirname + &quot;/failure.html&quot;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.listen(&quot;3000&quot;,function()&#123;</span><br><span class="line">console.log(&quot;Server is  running on port 3000&quot;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="app-js-使用try–catch的版本"><a href="#app-js-使用try–catch的版本" class="headerlink" title="app.js(使用try–catch的版本)"></a>app.js(使用try–catch的版本)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const request = require(&quot;request&quot;);</span><br><span class="line">const mailchimp = require(&quot;@mailchimp/mailchimp_marketing&quot;);</span><br><span class="line"></span><br><span class="line">mailchimp.setConfig(&#123;</span><br><span class="line">  apiKey: &quot;2fde44fd73cf51f578dbbaa03c9ef6a4&quot;,</span><br><span class="line">  server: &quot;us14&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">async function run() &#123;</span><br><span class="line">  const response = await mailchimp.ping.get();</span><br><span class="line">  console.log(response);</span><br><span class="line">&#125;</span><br><span class="line">run();</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;))</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;</span><br><span class="line">  extended: true</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line">  res.sendFile(__dirname + &quot;/signup.html&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/failure&quot;, function(req, res) &#123;</span><br><span class="line">  res.redirect(&quot;/&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  var firstName = req.body.姓氏;</span><br><span class="line">  var lastName = req.body.名字;</span><br><span class="line">  var emailAddress = req.body.email;</span><br><span class="line">  const listId = &quot;a500e5aabe&quot;;</span><br><span class="line">  const subscribingUser = &#123;</span><br><span class="line">    firstName: firstName,</span><br><span class="line">    lastName: lastName,</span><br><span class="line">    email: emailAddress</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  async function run() &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      const response = await mailchimp.lists.addListMember(listId, &#123;</span><br><span class="line">        email_address: subscribingUser.email,</span><br><span class="line">        status: &quot;subscribed&quot;,</span><br><span class="line">        merge_fields: &#123;</span><br><span class="line">          FNAME: subscribingUser.firstName,</span><br><span class="line">          LNAME: subscribingUser.lastName</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      res.sendFile(__dirname + &quot;/success.html&quot;);</span><br><span class="line">      console.log(</span><br><span class="line">        `Successfully added contact as an audience member. The contact&#x27;s id is $&#123;</span><br><span class="line">        response.id</span><br><span class="line">      &#125;.`</span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">      res.sendFile(__dirname + &quot;/failure.html&quot;);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  run(); //run沒有寫出來整個方程式會沒有運作</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(&quot;3000&quot;, function() &#123;</span><br><span class="line">  console.log(&quot;Server is  running on port 3000&quot;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="app-ja-導師版本"><a href="#app-ja-導師版本" class="headerlink" title="app.ja(導師版本)"></a>app.ja(導師版本)</h3><ol>
<li>mailchimp 希望以<strong>JSON形式</strong>收到會員資料,所以我們要做的是把會員資料變成JSON形式傳給mailchimp伺服器</li>
<li>建立一個變數以javascript形式儲存會員資料<br><a target="_blank" rel="noopener" href="https://mailchimp.com/developer/marketing/api/interest-categories/">https://mailchimp.com/developer/marketing/api/interest-categories/</a> 在此頁面確認 path parameters</li>
</ol>
<p>new_members: type為object[]<br>email_address:type為string<br>status:type為string<br>merge_fields:type為object<br>firstname網站使用的名稱為(示意圖在下):FNAME<br>lastname網站使用的名稱為(示意圖在下):LNAME</p>
<p><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC20-2%E7%AF%80mailchimpmergefield%E7%A4%BA%E6%84%8F%E5%9C%96.png" alt="網頁開發第20-2節mailchimpmergefield.png"></p>
<p>mailchimp範例(JSON形式)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;new_members&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;id&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;email_address&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;unique_email_id&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;email_type&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;status&quot;: &quot;subscribed&quot;,</span><br><span class="line">      &quot;merge_fields&quot;: &#123;</span><br><span class="line">        &quot;property1&quot;: null,</span><br><span class="line">        &quot;property2&quot;: null</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;interests&quot;: &#123;</span><br><span class="line">        &quot;property1&quot;: true,</span><br><span class="line">        &quot;property2&quot;: true</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;stats&quot;: &#123;</span><br><span class="line">        &quot;avg_open_rate&quot;: 0,</span><br><span class="line">        &quot;avg_click_rate&quot;: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;ip_signup&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;timestamp_signup&quot;: &quot;2019-08-24T14:15:22Z&quot;,</span><br><span class="line">      &quot;ip_opt&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;timestamp_opt&quot;: &quot;2019-08-24T14:15:22Z&quot;,</span><br><span class="line">      &quot;member_rating&quot;: 0,</span><br><span class="line">      &quot;last_changed&quot;: &quot;2019-08-24T14:15:22Z&quot;,</span><br><span class="line">      &quot;language&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;vip&quot;: true,</span><br><span class="line">      &quot;email_client&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;location&quot;: &#123;</span><br><span class="line">        &quot;latitude&quot;: 0,</span><br><span class="line">        &quot;longitude&quot;: 0,</span><br><span class="line">        &quot;gmtoff&quot;: 0,</span><br><span class="line">        &quot;dstoff&quot;: 0,</span><br><span class="line">        &quot;country_code&quot;: &quot;string&quot;,</span><br><span class="line">        &quot;timezone&quot;: &quot;string&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;last_note&quot;: &#123;</span><br><span class="line">        &quot;note_id&quot;: 0,</span><br><span class="line">        &quot;created_at&quot;: &quot;2019-08-24T14:15:22Z&quot;,</span><br><span class="line">        &quot;created_by&quot;: &quot;string&quot;,</span><br><span class="line">        &quot;note&quot;: &quot;string&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;tags_count&quot;: 0,</span><br><span class="line">      &quot;tags&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;id&quot;: 0,</span><br><span class="line">          &quot;name&quot;: &quot;string&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;list_id&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;_links&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;rel&quot;: &quot;string&quot;,</span><br><span class="line">          &quot;href&quot;: &quot;string&quot;,</span><br><span class="line">          &quot;method&quot;: &quot;GET&quot;,</span><br><span class="line">          &quot;targetSchema&quot;: &quot;string&quot;,</span><br><span class="line">          &quot;schema&quot;: &quot;string&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;updated_members&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;id&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;email_address&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;unique_email_id&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;email_type&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;status&quot;: &quot;subscribed&quot;,</span><br><span class="line">      &quot;merge_fields&quot;: &#123;</span><br><span class="line">        &quot;property1&quot;: null,</span><br><span class="line">        &quot;property2&quot;: null</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;interests&quot;: &#123;</span><br><span class="line">        &quot;property1&quot;: true,</span><br><span class="line">        &quot;property2&quot;: true</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;stats&quot;: &#123;</span><br><span class="line">        &quot;avg_open_rate&quot;: 0,</span><br><span class="line">        &quot;avg_click_rate&quot;: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;ip_signup&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;timestamp_signup&quot;: &quot;2019-08-24T14:15:22Z&quot;,</span><br><span class="line">      &quot;ip_opt&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;timestamp_opt&quot;: &quot;2019-08-24T14:15:22Z&quot;,</span><br><span class="line">      &quot;member_rating&quot;: 0,</span><br><span class="line">      &quot;last_changed&quot;: &quot;2019-08-24T14:15:22Z&quot;,</span><br><span class="line">      &quot;language&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;vip&quot;: true,</span><br><span class="line">      &quot;email_client&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;location&quot;: &#123;</span><br><span class="line">        &quot;latitude&quot;: 0,</span><br><span class="line">        &quot;longitude&quot;: 0,</span><br><span class="line">        &quot;gmtoff&quot;: 0,</span><br><span class="line">        &quot;dstoff&quot;: 0,</span><br><span class="line">        &quot;country_code&quot;: &quot;string&quot;,</span><br><span class="line">        &quot;timezone&quot;: &quot;string&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;last_note&quot;: &#123;</span><br><span class="line">        &quot;note_id&quot;: 0,</span><br><span class="line">        &quot;created_at&quot;: &quot;2019-08-24T14:15:22Z&quot;,</span><br><span class="line">        &quot;created_by&quot;: &quot;string&quot;,</span><br><span class="line">        &quot;note&quot;: &quot;string&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;tags_count&quot;: 0,</span><br><span class="line">      &quot;tags&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;id&quot;: 0,</span><br><span class="line">          &quot;name&quot;: &quot;string&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;list_id&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;_links&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;rel&quot;: &quot;string&quot;,</span><br><span class="line">          &quot;href&quot;: &quot;string&quot;,</span><br><span class="line">          &quot;method&quot;: &quot;GET&quot;,</span><br><span class="line">          &quot;targetSchema&quot;: &quot;string&quot;,</span><br><span class="line">          &quot;schema&quot;: &quot;string&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;errors&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;email_address&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;error&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;error_code&quot;: &quot;ERROR_CONTACT_EXISTS&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;total_created&quot;: 42,</span><br><span class="line">  &quot;total_updated&quot;: 42,</span><br><span class="line">  &quot;error_count&quot;: 42,</span><br><span class="line">  &quot;_links&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;rel&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;href&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;method&quot;: &quot;GET&quot;,</span><br><span class="line">      &quot;targetSchema&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;schema&quot;: &quot;string&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>建立要傳去mailchimp伺服器的資料形式(javascript object形式)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const data=&#123;</span><br><span class="line">   members:[</span><br><span class="line">    &#123;</span><br><span class="line">      email_address: emailAddress,</span><br><span class="line">      status:&quot;subscribed&quot;,</span><br><span class="line">      merge_fields:&#123;</span><br><span class="line">        FNAME:firstName,</span><br><span class="line">        LNAME:lastName</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>轉換data的形式:從javascript object轉為JSON形式<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var jsonData =JSON.stringify(data)</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https.get()</span><br><span class="line"></span><br><span class="line">https.get(url,function()&#123;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>先前使用的function,但是只有從伺服器取得資料的作用,only make get requests when you want data from an external resourse,但不是我們目前需要的,<strong>we actually want to post data to the external resource</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">https.request(options[, callback])#</span><br><span class="line">https.request(url[, options][, callback])#</span><br><span class="line">History</span><br><span class="line">url &lt;string&gt; | &lt;URL&gt;</span><br><span class="line">options &lt;Object&gt; | &lt;string&gt; | &lt;URL&gt; Accepts all options from http.request(), with some differences in default values:</span><br><span class="line">protocol Default: &#x27;https:&#x27;</span><br><span class="line">port Default: 443</span><br><span class="line">agent Default: https.globalAgent</span><br><span class="line">callback &lt;Function&gt;</span><br><span class="line">Returns: &lt;http.ClientRequest&gt;</span><br><span class="line">Makes a request to a secure web server.</span><br><span class="line"></span><br><span class="line">The following additional options from tls.connect() are also accepted: ca, cert, ciphers, clientCertEngine, crl, dhparam, ecdhCurve, honorCipherOrder, key, passphrase, pfx, rejectUnauthorized, secureOptions, secureProtocol, servername, sessionIdContext, highWaterMark.</span><br><span class="line"></span><br><span class="line">options can be an object, a string, or a URL object. If options is a string, it is automatically parsed with new URL(). If it is a URL object, it will be automatically converted to an ordinary options object.</span><br><span class="line"></span><br><span class="line">https.request() returns an instance of the http.ClientRequest class. The ClientRequest instance is a writable stream. If one needs to upload a file with a POST request, then write to the ClientRequest object.</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>require https <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const https = require(&quot;https&quot;);</span><br></pre></td></tr></table></figure></li>
</ol>
<p>We are going to pass in firstly our url,and then we are going to pass in our options,and finally we are going to have a callback function,which is going to give us a response from the Mailchimp </p>
<p>API的標準形式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://&lt;dc&gt;.api.mailchimp.com/3.0/lists/&#123;list_id&#125;</span><br><span class="line">&lt;dc&gt;:個人網頁網址確認</span><br><span class="line">list_id:個人網頁確認</span><br></pre></td></tr></table></figure>

<p>程式碼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const request = require(&quot;request&quot;);</span><br><span class="line">const mailchimp = require(&quot;@mailchimp/mailchimp_marketing&quot;);</span><br><span class="line">const https = require(&quot;https&quot;);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;))</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended: true&#125;));</span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line">  res.sendFile(__dirname + &quot;/signup.html&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/failure&quot;, function(req, res) &#123;</span><br><span class="line">  res.redirect(&quot;/&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  const firstName = req.body.姓氏;</span><br><span class="line">  const lastName = req.body.名字;</span><br><span class="line">  const emailAddress = req.body.email;</span><br><span class="line">  const data=&#123;</span><br><span class="line">     members:[</span><br><span class="line">    &#123;</span><br><span class="line">      email_address: emailAddress,</span><br><span class="line">      status:&quot;subscribed&quot;,</span><br><span class="line">      merge_fields:&#123;</span><br><span class="line">        FNAME:firstName,</span><br><span class="line">        LNAME:lastName</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line">const jsonData =JSON.stringify(data);</span><br><span class="line">const url = &quot;https://us14.api.mailchimp.com/3.0/lists/a500e5aabe&quot;;</span><br><span class="line">const options =&#123;</span><br><span class="line">  method:&quot;POST&quot;,</span><br><span class="line">  auth:&quot;Jeremy:2fde44fd73cf51f578dbbaa03c9ef6a4-us14&quot;</span><br><span class="line">&#125;</span><br><span class="line">https.request(url,options,function(response)&#123;</span><br><span class="line">response.on(&quot;data&quot;,function(data)&#123;</span><br><span class="line">console.log(JSON.parse(data));</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(&quot;3000&quot;, function() &#123;</span><br><span class="line">  console.log(&quot;Server is  running on port 3000&quot;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>We might be wondering ,we make a request ,but nowhere in this request or in our url,or in our options have we specified what it is that we want to send to Mailchimp,namely our jsonData,in order to send that data ,we have to save our request in a const and later on we can use that const request to send things over to the Mailchimp server by calling request.write,let us create a new const call request,because we do not want to conflict with our req,and then we are going to use the request and we are going to call request.write </p>
<p>更新後程式碼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&quot;express&quot;);</span><br><span class="line">const bodyParser = require(&quot;body-parser&quot;);</span><br><span class="line">const request = require(&quot;request&quot;);</span><br><span class="line">const mailchimp = require(&quot;@mailchimp/mailchimp_marketing&quot;);</span><br><span class="line">const https = require(&quot;https&quot;);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;public&quot;))</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;</span><br><span class="line">  extended: true</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line">  res.sendFile(__dirname + &quot;/signup.html&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/failure&quot;, function(req, res) &#123;</span><br><span class="line">  res.redirect(&quot;/&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&quot;/&quot;, function(req, res) &#123;</span><br><span class="line"></span><br><span class="line">  const firstName = req.body.姓氏;</span><br><span class="line">  const lastName = req.body.名字;</span><br><span class="line">  const emailAddress = req.body.email;</span><br><span class="line">  const data = &#123;</span><br><span class="line">    members: [&#123;</span><br><span class="line">      email_address: emailAddress,</span><br><span class="line">      status: &quot;subscribed&quot;,</span><br><span class="line">      merge_fields: &#123;</span><br><span class="line">        FNAME: firstName,</span><br><span class="line">        LNAME: lastName</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;;</span><br><span class="line">  const jsonData = JSON.stringify(data);</span><br><span class="line">  const url = &quot;https://us14.api.mailchimp.com/3.0/lists/a500e5aabe&quot;;</span><br><span class="line">  const options = &#123;</span><br><span class="line">    method: &quot;POST&quot;,</span><br><span class="line">    auth: &quot;Jeremy:1e322b684087d2446784d2e07f916491b-us94&quot; //Jeremy 的部分可隨意</span><br><span class="line">  &#125;</span><br><span class="line">  const request = https.request(url, options, function(response) &#123;</span><br><span class="line">    if (response.statusCode === 200) &#123;  //200不要寫成string </span><br><span class="line">      res.sendFile(__dirname + &quot;/success.html&quot;); //這邊的res是對應到app.post</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      res.sendFile(__dirname + &quot;/failure.html&quot;); //確認是否向mailchimp request 成功</span><br><span class="line">    &#125;;</span><br><span class="line">    response.on(&quot;data&quot;, function(data) &#123;</span><br><span class="line">      console.log(JSON.parse(data));</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  request.write(jsonData);</span><br><span class="line">  request.end()</span><br><span class="line">&#125;);</span><br><span class="line">app.listen(&quot;3000&quot;, function() &#123;</span><br><span class="line">  console.log(&quot;Server is  running on port 3000&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>個人理解:在收到client資料之後(javascript object),儲存並轉換成JSON形式並儲存到jsonData,同時向mailchimp伺服器發出request的請求,mailchimp server收到資料並回傳example(我們傳過去的資料)之後,我們把他儲存在 const request,並且使用request.write正式寫入mailchimp server,request.end()代表request結束</p>
<h3 id="Deploy-your-server-with-Heroku"><a href="#Deploy-your-server-with-Heroku" class="headerlink" title="Deploy your server with Heroku"></a>Deploy your server with Heroku</h3><p>We no longer just deploying static website,we can not use github or any server that only support static content unless we want to build our own server stack and live with noisy servers running 24&#x2F;7,so we are going to rent some servers from somebody else so they can have all of the hassle and all the pain of keeping our server runnning up and make sure that people can access it over the World Wide Web </p>
<p><a target="_blank" rel="noopener" href="https://www.heroku.com/">https://www.heroku.com/</a><br>免費註冊 可以最多五個專案使用他們的服務,they will host your server<br>to keep your website live on the internet and want your app gets pupular and you have lots and lots of request to your server,then you can scale it up dynamically with Hiroku pretty much just by using a slider bar,and immediately you can get access to more servers who can respond to request from more browser,and this is when you have made it in the world,they can support your success as well,and only at that stage,you start paying them for the privilege</p>
<p><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/categories/reference">https://devcenter.heroku.com/categories/reference</a> Heroku的文件中心,點擊get started,點擊node.js,跟著指示使用終端機操作</p>
<p>Currently we are listening on a local port ,which is port 3000,once we upload our server,then our code will be running on their system ,and their server might not be port 3000,Heroku will pick and choose a port for you </p>
<p>在app.js </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.listen(process.env.PORT || 3000, function() &#123;</span><br><span class="line">  console.log(&quot;Server is  running on port 3000&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>This is basically a dynamica port that Heroku will define ,and it allow us to work seamlessly(無縫的) with their system,在本地無法使用,因為the process object(process.env.PORT) is define by Heroku</p>
<p>改為這樣,可以測試本地以及連接Heroku</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.listen(process.env.PORT || 3000, function() &#123;</span><br><span class="line">  console.log(&quot;Server is  running on port 3000&quot;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Define-a-procfile"><a href="#Define-a-procfile" class="headerlink" title="Define a procfile"></a>Define a procfile</h3><ol>
<li><p>終端機前往專案資料夾</p>
</li>
<li></li>
</ol>
<p>hyper terminal</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch Procfile</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>使用atom 打開 Procfile</li>
</ol>
<p>Procfile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web: node app.js</span><br></pre></td></tr></table></figure>
<p>This is all tell that we need to tell Heroku how to launch our app and also which file actually contains our server code</p>
<ol start="4">
<li><p>確認目前位置在專案裡面</p>
</li>
<li><p>hyper terminal </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add . </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m&quot;first commit&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>hyper terminal </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroko create</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push heroku master</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="確認哪邊出錯"><a href="#確認哪邊出錯" class="headerlink" title="確認哪邊出錯"></a>確認哪邊出錯</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku log </span><br></pre></td></tr></table></figure>

<h3 id="檔案資料變更之後要更新"><a href="#檔案資料變更之後要更新" class="headerlink" title="檔案資料變更之後要更新"></a>檔案資料變更之後要更新</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m&quot;變更內容&quot;</span><br><span class="line">git push heroku master</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://razieldu.github.io">Jeremy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://razieldu.github.io/2022/03/23/Udemy-WebDevelopment-ch20-2-APIs-Application-Programming-Interfaces/">https://razieldu.github.io/2022/03/23/Udemy-WebDevelopment-ch20-2-APIs-Application-Programming-Interfaces/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/03/25/Udemy-WebDevelopment-ch21-Git-GitHub-and-Version-Control/"><img class="prev-cover" src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Udemy Web Development Ch21 Git Gihub and Version Control</div></div></a></div><div class="next-post pull-right"><a href="/2022/03/17/Udemy-WebDevelopment-ch20-1-APIs-Application-Programming-Interfaces/"><img class="next-cover" src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Udemy Web Development Ch20-1 APIs Application Programming Interfaces</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jeremy</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">74</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Razieldu"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Mailchimp-API"><span class="toc-number">1.</span> <span class="toc-text">The Mailchimp API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%AA%94%E6%A1%88%E8%A8%AD%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">基本檔案設置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8hyper-terminal-%E4%B8%80%E6%AC%A1%E5%BB%BA%E7%AB%8B%E5%A4%9A%E5%80%8B%E6%AA%94%E6%A1%88"><span class="toc-number">3.</span> <span class="toc-text">使用hyper terminal 一次建立多個檔案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A4%87%E8%A3%BDbootstrap%E7%AF%84%E6%9C%AC"><span class="toc-number">4.</span> <span class="toc-text">複製bootstrap範本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8localhost-3000-%E8%A8%AD%E7%BD%AE%E4%BC%BA%E6%9C%8D%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">在localhost:3000 設置伺服器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Posting-Data-to-Mailchimp%E2%80%99s-Server-via-their-API"><span class="toc-number">6.</span> <span class="toc-text">Posting Data to Mailchimp’s Server via their API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Adding-Success-and-Failure-Pages"><span class="toc-number">7.</span> <span class="toc-text">Adding Success and Failure Pages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-js-%E7%B6%B2%E5%8F%8B%E7%89%88%E6%9C%AC"><span class="toc-number">8.</span> <span class="toc-text">app.js(網友版本)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-js-%E4%BD%BF%E7%94%A8try%E2%80%93catch%E7%9A%84%E7%89%88%E6%9C%AC"><span class="toc-number">9.</span> <span class="toc-text">app.js(使用try–catch的版本)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-ja-%E5%B0%8E%E5%B8%AB%E7%89%88%E6%9C%AC"><span class="toc-number">10.</span> <span class="toc-text">app.ja(導師版本)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deploy-your-server-with-Heroku"><span class="toc-number">11.</span> <span class="toc-text">Deploy your server with Heroku</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Define-a-procfile"><span class="toc-number">12.</span> <span class="toc-text">Define a procfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A2%BA%E8%AA%8D%E5%93%AA%E9%82%8A%E5%87%BA%E9%8C%AF"><span class="toc-number">13.</span> <span class="toc-text">確認哪邊出錯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AA%94%E6%A1%88%E8%B3%87%E6%96%99%E8%AE%8A%E6%9B%B4%E4%B9%8B%E5%BE%8C%E8%A6%81%E6%9B%B4%E6%96%B0"><span class="toc-number">14.</span> <span class="toc-text">檔案資料變更之後要更新</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/05/Udemy-React-TheCompleteGuide-ch23-Next-JS/" title="Udemy-React-TheCompleteGuide ch23 Next JS  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch23 Next JS  "/></a><div class="content"><a class="title" href="/2022/08/05/Udemy-React-TheCompleteGuide-ch23-Next-JS/" title="Udemy-React-TheCompleteGuide ch23 Next JS  ">Udemy-React-TheCompleteGuide ch23 Next JS  </a><time datetime="2022-08-05T08:51:55.000Z" title="Created 2022-08-05 16:51:55">2022-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/24/Redux-VS-Redux-ToolKit/" title="Redux VS Redux-ToolKit"><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redux VS Redux-ToolKit"/></a><div class="content"><a class="title" href="/2022/07/24/Redux-VS-Redux-ToolKit/" title="Redux VS Redux-ToolKit">Redux VS Redux-ToolKit</a><time datetime="2022-07-24T04:43:06.000Z" title="Created 2022-07-24 12:43:06">2022-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/15/Udemy-React-TheCompleteGuide-ch22-React-Authentication/" title="Udemy-React-TheCompleteGuide ch22 React Authenticaton  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch22 React Authenticaton  "/></a><div class="content"><a class="title" href="/2022/07/15/Udemy-React-TheCompleteGuide-ch22-React-Authentication/" title="Udemy-React-TheCompleteGuide ch22 React Authenticaton  ">Udemy-React-TheCompleteGuide ch22 React Authenticaton  </a><time datetime="2022-07-15T07:47:55.000Z" title="Created 2022-07-15 15:47:55">2022-07-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/14/Udemy-React-TheCompleteGuide-ch21-React-Deploy/" title="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  "/></a><div class="content"><a class="title" href="/2022/07/14/Udemy-React-TheCompleteGuide-ch21-React-Deploy/" title="Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  ">Udemy-React-TheCompleteGuide ch21 Deploy React App with Firebase  </a><time datetime="2022-07-14T05:39:55.000Z" title="Created 2022-07-14 13:39:55">2022-07-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/06/Udemy-React-TheCompleteGuide-ch20-React-Router/" title="Udemy-React-TheCompleteGuide ch20 Muti Page SPA with React Router "><img src="https://github.com/Razieldu/BLOG-IMG/raw/main/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%9C%96%E7%89%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Udemy-React-TheCompleteGuide ch20 Muti Page SPA with React Router "/></a><div class="content"><a class="title" href="/2022/07/06/Udemy-React-TheCompleteGuide-ch20-React-Router/" title="Udemy-React-TheCompleteGuide ch20 Muti Page SPA with React Router ">Udemy-React-TheCompleteGuide ch20 Muti Page SPA with React Router </a><time datetime="2022-07-06T11:28:55.000Z" title="Created 2022-07-06 19:28:55">2022-07-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Jeremy</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>